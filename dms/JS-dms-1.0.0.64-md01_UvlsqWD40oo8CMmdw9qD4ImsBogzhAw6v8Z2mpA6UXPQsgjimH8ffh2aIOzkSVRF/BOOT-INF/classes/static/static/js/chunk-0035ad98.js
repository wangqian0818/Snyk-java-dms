(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0035ad98"],{"1c4c":function(e,a,t){},"2bc1":function(e,a,t){"use strict";t.r(a);var i=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-card",{staticStyle:{"margin-top":"30px"}},[t("div",{staticClass:"search"},[t("div",{staticClass:"title"},[e._v("查询条件")]),t("div",{staticClass:"content"},[t("div",{staticClass:"filter-container"},[1!=e.dmsType?t("span",{staticClass:"inner",staticStyle:{width:"200px","margin-right":"20px"}},[t("b-cascader",{ref:"cascaderRef",attrs:{"show-all-channels":!1,"clear-on-init":!1},on:{change:e.cascaderHandler}})],1):e._e(),t("a-select",{staticStyle:{width:"150px","margin-right":"16px"},attrs:{options:e.timeTypeOptions,placeholder:"请选择报表类型"},on:{change:e.handleReportTypeChange},model:{value:e.search.timeType,callback:function(a){e.$set(e.search,"timeType",a)},expression:"search.timeType"}}),t("a-date-picker",{staticStyle:{width:"200px","margin-right":"16px"},attrs:{format:e.datePickerProps.format,allowClear:!1,"disabled-date":e.disabledDate,placeholder:e.datePickerProps.placeholder,picker:e.datePickerProps.picker},on:{change:e.handleDateChange},model:{value:e.search.datePickerValue,callback:function(a){e.$set(e.search,"datePickerValue",a)},expression:"search.datePickerValue"}}),t("a-button",{attrs:{type:"primary",loading:e.isLoading,disabled:e.isLoading},on:{click:e.handleSearch}},[e._v("查询")])],1)])]),t("a-spin",{attrs:{spinning:e.isLoading,tip:"正在加载，请稍后"}},[t("div",{staticClass:"body"},[t("a-row",[t("a-col",{attrs:{span:24}},[t("a-card",{staticStyle:{"margin-top":"30px",padding:"20px 0"}},[t("a-row",{staticStyle:{"margin-bottom":"30px",padding:"0 20px"},attrs:{gutter:20}},[t("a-col",{attrs:{span:12}},[t("LineChart",{ref:"lineChart2",attrs:{title:"告警信息条数统计图",timeType:e.search.timeType,specificTime:e.displaySpecificTime,data:e.chartData.numList,xdata:e.chartData.xList,unit:"条","empty-text":e.emptyText,typeText:"告警条数",location:e.search.alarmTypeName}})],1),t("a-col",{attrs:{span:12}},[t("LineChart",{ref:"lineChart1",attrs:{title:"告警信息次数统计图",timeType:e.search.timeType,specificTime:e.displaySpecificTime,data:e.chartData.bytesList,xdata:e.chartData.xList,unit:"次","empty-text":e.emptyText,typeText:"告警次数",location:e.search.alarmTypeName}})],1)],1),t("a-row",{staticStyle:{"margin-bottom":"30px",padding:"0 20px"},attrs:{gutter:20}},[t("a-col",{attrs:{span:24}},[t("div",{staticClass:"table-title"},[e._v("告警信息"+e._s(e.timeSegmentDesc)+"统计表")]),t("div",{staticClass:"table-container"},[t("a-table",{attrs:{columns:e.columns1,"data-source":e.chartData.byteNumList,pagination:!1,scroll:{y:300},bordered:"",locale:{emptyText:e.emptyText},rowKey:function(e){return e.timePeriod||e.key}},scopedSlots:e._u([{key:"bodyCell",fn:function(a){var t=a.column,i=a.record;return[["inFlow","outFlow"].includes(t.dataIndex)?[e._v(" "+e._s(e.formatFlow(i[t.dataIndex]))+" ")]:e._e()]}}])})],1)])],1)],1)],1),t("a-col",{attrs:{span:24}},[t("a-card",{staticStyle:{"margin-top":"30px",padding:"20px 0"}},[t("a-row",{staticStyle:{"margin-bottom":"30px",padding:"0 20px"},attrs:{gutter:20}},[t("a-col",{attrs:{span:12}},[t("BarChart",{ref:"barChart2",attrs:{title:"告警信息条数TOP5排名",data:e.chartData.numTop,xdata:e.chartData.numTopName,unit:"条",timeType:e.search.timeType,specificTime:e.displaySpecificTime,"empty-text":e.emptyText,typeText:"告警条数",location:e.search.alarmTypeName}})],1),t("a-col",{attrs:{span:12}},[t("BarChart",{ref:"barChart1",attrs:{title:"告警信息次数TOP5排名",data:e.chartData.bytesTop,xdata:e.chartData.bytesTopName,unit:"次",timeType:e.search.timeType,specificTime:e.displaySpecificTime,"empty-text":e.emptyText,typeText:"告警次数",location:e.search.alarmTypeName}})],1),t("a-col",{attrs:{span:12}},[t("PieChart",{ref:"pieChart2",attrs:{title:"告警信息条数占比",data:e.chartData.numZb,xdata:e.chartData.numZbName,unit:"次",timeType:e.search.timeType,specificTime:e.displaySpecificTime,"empty-text":e.emptyText,location:e.search.alarmTypeName}})],1),t("a-col",{attrs:{span:12}},[t("PieChart",{ref:"pieChart1",attrs:{title:"告警信息次数占比",data:e.chartData.bytesZb,xdata:e.chartData.bytesZbName,unit:"次",timeType:e.search.timeType,specificTime:e.displaySpecificTime,"empty-text":e.emptyText,location:e.search.alarmTypeName}})],1)],1),t("a-row",{staticStyle:{"margin-bottom":"30px",padding:"0 20px"},attrs:{gutter:20}},[t("a-col",{attrs:{span:24}},[t("div",{staticClass:"table-title"},[e._v("告警信息"+e._s(e.timeSummaryDesc)+"排名表")]),t("div",{staticClass:"table-container"},[t("a-table",{attrs:{columns:e.columns2,"data-source":e.chartData.busiList,pagination:!1,scroll:{y:300},bordered:"",locale:{emptyText:e.emptyText},rowKey:function(e){return e.name||e.key}},scopedSlots:e._u([{key:"bodyCell",fn:function(a){var t=a.column,i=a.record;return[["inFlow","outFlow"].includes(t.dataIndex)?[e._v(" "+e._s(e.formatFlow(i[t.dataIndex]))+" ")]:e._e(),"ratio"===t.dataIndex?[e._v(e._s((i[t.dataIndex]||0).toFixed(2))+"%")]:e._e()]}}])})],1)])],1)],1)],1)],1)],1)])],1)},r=[],s=t("1da1"),n=t("ade3"),l=(t("96cf"),t("ac1f"),t("841c"),t("99af"),t("7db0"),t("d3b7"),t("b0c0"),t("b680"),t("c1df")),c=t.n(l),o=t("542d"),p=t("2b16"),m=t("2860"),u=t("b775"),d=t("10d2"),h=t("c2f2"),y={DAY:"day",WEEK:"week",MONTH:"month"},b={name:"FileSyncAnalysisReport",components:{LineChart:o["a"],BarChart:p["a"],PieChart:m["a"],BCascader:d["a"]},mixins:[h["a"]],data:function(){return{search:{deviceId:"",channelInfoId:"",timeType:y.DAY,alarmTypeName:"",datePickerValue:c()()},typeList:[],isLoading:!1,chartData:{byteNumList:[],xList:[],busiList:[],bytesList:[],numList:[],bytesTop:[],bytesTopName:[],numTop:[],numTopName:[],bytesZb:[],bytesZbName:[],numZb:[],numZbName:[]},dimensionMap:{11:[{value:"sip",label:"源IP"},{value:"dip",label:"目的IP"}],10:[{value:"sip",label:"源IP"},{value:"clientUser",label:"信息交换用户"}],13:[{value:"sip",label:"源IP"},{value:"dip",label:"目的IP"}],3:[{value:"sip",label:"源IP"},{value:"dip",label:"目的IP"},{value:"dport",label:"目的端口"},{value:"protocol",label:"协议类型"}],9:[{value:"sip",label:"源IP"},{value:"priority",label:"事件级别"},{value:"classType",label:"事件类别"}],14:[{value:"sip",label:"源IP"},{value:"severity",label:"严重程度"},{value:"ddosType",label:"DDoS攻击类型"}],15:[{value:"sip",label:"源IP"},{value:"dip",label:"目的IP"}],16:[{value:"sip",label:"源IP"},{value:"severity",label:"严重程度"},{value:"classType",label:"事件类别"},{value:"describe",label:"内容"}],17:[{value:"sip",label:"源IP"},{value:"appName",label:"服务名称"},{value:"ruleName",label:"策略名称"}],18:[{value:"sip",label:"源IP"},{value:"appName",label:"服务名称"},{value:"ruleName",label:"策略名称"}],19:[{value:"sip",label:"源IP"},{value:"appName",label:"服务名称"},{value:"ruleName",label:"策略名称"}],2:[{value:"sip",label:"源IP"},{value:"appName",label:"服务名称"},{value:"ruleName",label:"策略名称"}],12:[{value:"sip",label:"源IP"},{value:"appName",label:"服务名称"},{value:"filterType",label:"文件过滤类型"}],20:[{value:"sip",label:"源IP"},{value:"appName",label:"服务名称"},{value:"action",label:"动作"}]}}},computed:{displaySpecificTime:function(){var e=this.search,a=e.timeType,t=e.datePickerValue;if(!c.a.isMoment(t))return"";switch(a){case y.DAY:return t.format("YYYY-MM-DD");case y.WEEK:var i=t.isoWeek(),r=t.year();return"".concat(r,"-第").concat(i,"周");case y.MONTH:return t.format("YYYY-MM");default:return""}},timeTypeOptions:function(){return[{value:y.DAY,label:"日报表"},{value:y.WEEK,label:"周报表"},{value:y.MONTH,label:"月报表"}]},datePickerProps:function(){var e,a=(e={},Object(n["a"])(e,y.DAY,{format:"YYYY-MM-DD",placeholder:"请选择日期",picker:void 0}),Object(n["a"])(e,y.WEEK,{format:"YYYY-第WW周",placeholder:"请选择周",picker:"week"}),Object(n["a"])(e,y.MONTH,{format:"YYYY-MM",placeholder:"请选择月份",picker:"month"}),e);return a[this.search.timeType]},dimensionTypeOptions:function(){var e=this.search.alarmType;return e&&this.dimensionMap[e]||[]},timeSegmentDesc:function(){var e,a=(e={},Object(n["a"])(e,y.DAY,"逐时"),Object(n["a"])(e,y.WEEK,"逐日"),Object(n["a"])(e,y.MONTH,"逐日"),e);return a[this.search.timeType]},timeSummaryDesc:function(){var e,a=(e={},Object(n["a"])(e,y.DAY,"当日"),Object(n["a"])(e,y.WEEK,"当周"),Object(n["a"])(e,y.MONTH,"当月"),e);return a[this.search.timeType]},columns1:function(){return[{title:"时间段",dataIndex:"fieldName",key:"fieldName",align:"center"},{title:"告警条数",dataIndex:"fieldNum",key:"fieldNum",align:"center"},{title:"告警次数",dataIndex:"fieldByte",key:"fieldByte",align:"center"}]},columns2:function(){return[{title:"告警名称",dataIndex:"fieldName",key:"fieldName",align:"center"},{title:"告警条数",dataIndex:"fieldNum",key:"fieldNum",align:"center"},{title:"告警次数",dataIndex:"fieldByte",key:"fieldByte",align:"center"}]},emptyText:function(){return"暂无".concat(this.timeSummaryDesc,"告警数据")}},mounted:function(){this.getAlarmType(),1==this.dmsType&&this.handleSearch()},methods:{getAlarmType:function(){var e=this;Object(u["b"])("tool/alarm-config/type-names?listType=report",u["a"].GET).then((function(a){a&&(e.typeList=a||[])}))},initDateValue:function(){var e=c()();switch(this.search.timeType){case y.DAY:this.search.datePickerValue=e.clone();break;case y.WEEK:this.search.datePickerValue=e.clone().isoWeekday(1);break;case y.MONTH:this.search.datePickerValue=e.clone();break}},handleDateChange:function(e){this.search.datePickerValue=e?e.clone():c()(),this.search.alarmType="",this.search.alarmTypeName="",this.search.dimension="",this.handleSearch()},handleAlarmTypeChange:function(e){var a=this.typeList.find((function(a){return a.numValue===e}));if(this.search.alarmTypeName=a?a.name:"",e){var t=this.dimensionTypeOptions;this.search.dimension=t.length>0?t[0].value:""}else this.search.dimension="";this.handleSearch()},handleReportTypeChange:function(e){this.search.timeType=e,this.initDateValue(),this.clearChartData(),this.handleSearch()},disabledDate:function(e){return e&&e>c()().endOf("day")},formatDateForApi:function(e){if(!c.a.isMoment(e))return"";switch(this.search.timeType){case y.DAY:return e.format("YYYY-MM-DD");case y.WEEK:return e.isoWeekday(1).format("YYYY-MM-DD");case y.MONTH:return e.format("YYYY-MM");default:return""}},formatFlow:function(e){if("number"!==typeof e||isNaN(e))return"0 B";var a=1024,t=1024*a;return e<a?"".concat(e," B"):e<t?"".concat((e/a).toFixed(2)," KB"):"".concat((e/t).toFixed(2)," MB")},clearChartData:function(){this.chartData={byteNumList:[],xList:[],busiList:[],bytesList:[],numList:[],bytesTop:[],bytesTopName:[],numTop:[],numTopName:[],bytesZb:[],bytesZbName:[],numZb:[],numZbName:[]}},cascaderHandler:function(e){this.search.deviceId=e[0],this.search.channelInfoId=e[1],this.handleSearch()},handleSearch:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var t,i,r,s,n,l,o,p,m,d;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t=e,i=t.search,r=i.timeType,s=i.datePickerValue,n=i.alarmType,l=i.dimension,o=i.channelInfoId,p=i.deviceId,r&&c.a.isMoment(s)){a.next=5;break}return t.$message.warning("请完善报表类型、时间选择"),a.abrupt("return");case 5:if(!t.isLoading){a.next=7;break}return a.abrupt("return");case 7:return a.prev=7,t.isLoading=!0,t.clearChartData(),m={channelInfoId:o,deviceId:p,type:r,typeValue:t.formatDateForApi(s),alarmType:n,dimension:l},a.next=13,Object(u["b"])("form/alarm-forms",u["a"].POST,m);case 13:d=a.sent,t.chartData={byteNumList:d.byteNumList||[],xList:d.xList||[],busiList:d.busiList||[],bytesList:d.bytesList||[],numList:d.numList||[],bytesTop:d.bytesTop||[],bytesTopName:d.bytesTopName||[],numTop:d.numTop||[],numTopName:d.numTopName||[],bytesZb:d.bytesZb||[],bytesZbName:d.bytesZbName||[],numZb:d.numZb||[],numZbName:d.numZbName||[]},a.next=21;break;case 17:a.prev=17,a.t0=a["catch"](7),t.$message.error("数据加载失败：".concat(a.t0.message||"未知错误")),t.clearChartData();case 21:return a.prev=21,t.isLoading=!1,a.finish(21);case 24:case"end":return a.stop()}}),a,null,[[7,17,21,24]])})))()}}},f=b,T=(t("4084"),t("2877")),v=Object(T["a"])(f,i,r,!1,null,"5f3e8dce",null);a["default"]=v.exports},4084:function(e,a,t){"use strict";t("1c4c")}}]);