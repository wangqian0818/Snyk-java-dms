(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-159648ee"],{"126f":function(t,e,a){},3847:function(t,e,a){},"3e0e":function(t,e,a){"use strict";a("3847")},"4b5d":function(t,e,a){},"524c":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"page-menu"},[a("a-radio-group",{attrs:{value:t.menu},on:{change:t.handleMenuChange}},[t._l(t.menuLists,(function(e,n){return[t.permissionDeviceMenu.includes(e.value)?a("a-radio-button",{key:n,attrs:{value:e.value}},[t._v(t._s(e.menuName))]):t._e()]}))],2)],1),a("a-card",{staticStyle:{clear:"both"}},[a("div",{staticClass:"search"},[a("div",{staticClass:"title"},[t._v("查询条件")]),a("div",{staticClass:"content"},[t.fieldList.length>0?a("span",{staticClass:"outer"},[t._v("查询参数:")]):t._e(),t._l(t.fieldList,(function(e){return["操作模块"==e.name?a("span",{key:e.index,staticClass:"inner"},[1==t.menu?[a("a-select",{staticStyle:{width:"150px"},attrs:{placeholder:"请选择"+e.name},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}},[a("a-select-option",{attrs:{value:""}},[t._v("全部")]),a("a-select-option",{attrs:{value:"用户登录"}},[t._v("用户登录")]),a("a-select-option",{attrs:{value:"用户退出"}},[t._v("用户退出")])],1)]:[a("a-input",{staticClass:"i-width",attrs:{maxLength:64,placeholder:"请输入"+e.name},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}})]],2):"操作状态"==e.name?a("span",{key:e.index,staticClass:"inner"},[a("a-select",{staticStyle:{width:"150px"},attrs:{placeholder:"请选择"+e.name},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}},[a("a-select-option",{attrs:{value:""}},[t._v("全部")]),a("a-select-option",{attrs:{value:"true"}},[t._v("成功")]),a("a-select-option",{attrs:{value:"false"}},[t._v("失败")])],1)],1):a("span",{key:e.index,staticClass:"inner"},[a("a-input",{staticClass:"i-width",attrs:{maxLength:64,placeholder:"请输入"+e.name},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}})],1)]})),a("span",{staticClass:"outer"},[a("a-button",{staticClass:"button",attrs:{type:"primary"},on:{click:t.searchClick}},[t._v("查询")])],1),a("span",{staticClass:"outer"},[a("a-button",{staticClass:"button",on:{click:t.resetSearch}},[t._v("重置")])],1)],2)]),a("div",{staticClass:"body"},[a("div",{staticClass:"buttons"},[a("b-date-range",{attrs:{value:t.dateValue},on:{change:t.dateRangeChange1}}),t.readOnly||"logadmin"!=t.userName?t._e():a("a-button",{attrs:{type:"primary",icon:"export"},on:{click:function(e){return t.exports()}}},[t._v("批量导出")]),"logadmin"==t.userName&&"true"==t.logCanDeleted?[a("a-button",{attrs:{type:"primary",icon:"delete"},on:{click:function(e){return t.deleteLog()}}},[t._v("删除")])]:t._e(),a("a-button",{attrs:{type:"primary",icon:"sync"},on:{click:function(e){return t.clickSearch1()}}},[t._v("刷新")])],2),a("div",{staticClass:"title"},[t._v("查询结果")]),a("a-row",{staticClass:"table"},[a("a-col",{staticStyle:{padding:"0 12px"},attrs:{xl:24,lg:24,md:24,sm:24,xs:24}},[a("b-fixed-table",{attrs:{columns:t.columns,rowKey:"id",data:t.table.data,total:t.table.total,loading:t.loading,"init-page":t.page},on:{change:t.tableParamChanged},scopedSlots:t._u([{key:"timestamp",fn:function(e){var n=e.record;return[a("span",[t._v(t._s(t._f("convertTime")(n.timestamp)))])]}},{key:"state",fn:function(e){var n=e.record;return[1==n.state?a("span",[t._v("成功")]):0==n.state?a("span",[t._v("失败")]):a("span",[t._v("-")])]}},{key:"operations",fn:function(e){var n=e.record;return[a("span",[a("span",{staticClass:"oper",on:{click:function(e){return t.view(n)}}},[t._v("详情")])])]}}])})],1)],1)],1)])],1)},i=[],s=(a("b0c0"),a("d3b7"),a("159b"),a("25eb"),a("a9e3"),a("ac1f"),a("841c"),a("b64b"),a("e9c4"),a("c2f2")),r=a("1da1"),o=(a("96cf"),a("99af"),a("b775"));function c(t,e,a){return l.apply(this,arguments)}function l(){return l=Object(r["a"])(regeneratorRuntime.mark((function t(e,a,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(o["f"])("system-login-log/logs?offset=".concat((e-1)*a,"&limit=").concat(a).concat(n),o["a"].GET));case 1:case"end":return t.stop()}}),t)}))),l.apply(this,arguments)}function m(t,e,a,n){return u.apply(this,arguments)}function u(){return u=Object(r["a"])(regeneratorRuntime.mark((function t(e,a,n,i){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(o["f"])("system-login-log/del-logs?search=".concat(e,"&fieldName=").concat(a,"&startDate=").concat(n,"&endDate=").concat(i),o["a"].DELETE));case 1:case"end":return t.stop()}}),t)}))),u.apply(this,arguments)}function d(t){return f.apply(this,arguments)}function f(){return f=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(o["f"])("system-login-log/log/".concat(e),o["a"].GET));case 1:case"end":return t.stop()}}),t)}))),f.apply(this,arguments)}function p(t,e,a){return h.apply(this,arguments)}function h(){return h=Object(r["a"])(regeneratorRuntime.mark((function t(e,a,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(o["f"])("system-operation-log/logs?offset=".concat((e-1)*a,"&limit=").concat(a).concat(n),o["a"].GET));case 1:case"end":return t.stop()}}),t)}))),h.apply(this,arguments)}function v(t,e,a,n){return g.apply(this,arguments)}function g(){return g=Object(r["a"])(regeneratorRuntime.mark((function t(e,a,n,i){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(o["f"])("system-operation-log/del-logs?search=".concat(e,"&fieldName=").concat(a,"&startDate=").concat(n,"&endDate=").concat(i),o["a"].DELETE));case 1:case"end":return t.stop()}}),t)}))),g.apply(this,arguments)}function b(t){return D.apply(this,arguments)}function D(){return D=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(o["f"])("system-operation-log/log/".concat(e),o["a"].GET));case 1:case"end":return t.stop()}}),t)}))),D.apply(this,arguments)}var Y=a("8cff"),y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.form.init.show?a("div",[a("a-modal",{attrs:{closable:!0,title:t.form.init.title,width:t.form.init.width,"mask-closable":!1},model:{value:t.form.init.show,callback:function(e){t.$set(t.form.init,"show",e)},expression:"form.init.show"}},["delete"===t.form.name?a("div",[t._v(" 确定删除？ ")]):a("a-form-model",{ref:"form",class:{views:"view"===t.form.name},attrs:{model:t.form.init.data,rules:t.form.init.rules,"label-col":{span:t.form.init.labelSpan||6},"wrapper-col":{span:t.form.init.wrapperSpan||18}}},[void 0!==t.form.init.data.limit?a("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"条数",prop:"limit"}},[a("a-input",{staticStyle:{width:"100%"},attrs:{maxLength:10},model:{value:t.form.init.data.limit,callback:function(e){t.$set(t.form.init.data,"limit",e)},expression:"form.init.data.limit"}})],1):t._e()],1),a("template",{slot:"footer"},["export"===t.form.name?a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.exportData()}}},[t._v("导出")]):t._e(),a("a-button",{on:{click:function(e){return t.clickCancel()}}},[t._v("关闭")])],1)],2)],1):t._e()},w=[],x=(a("00b4"),a("c1df")),k=a.n(x),S=a("eb60"),M=a("d9f9"),_={name:"AuditSystemLoginLogDialog",components:{},mixins:[s["a"]],filters:{convertSecurityRank:M["x"],convertTime:M["C"],convertAuditEventLogExceptionType:M["e"],convertNoticeType:M["v"],convertDisposeType:M["k"]},props:{},data:function(){return{zhCN:S["a"],spinning:!1,state:"",params:"",parent:"",form:{view:{title:"详情",width:750,request:"",show:!0,data:{},rules:{}},export:{title:"导出",width:420,request:"",show:!0,timeRange:[k()().subtract(1,"days").format("YYYY-MM-DD HH:mm:ss"),k()().format("YYYY-MM-DD HH:mm:ss")],ranges:{},data:{startDate:k()().subtract(1,"days").format("YYYY-MM-DD HH:mm:ss"),endDate:k()().format("YYYY-MM-DD HH:mm:ss"),limit:1,offset:0},rules:{}}}}},created:function(){this.showDialog(this.state,this.params)},methods:{beforeShowDialog:function(){},beforeSave:function(){},close:function(){this.form.init.show=!1},disabledDate:function(t){return t>k()().endOf("day")},dateChange:function(t){this.form.init.data.startDate=t[0].format("YYYY-MM-DD HH:mm:ss"),this.form.init.data.endDate=t[1].format("YYYY-MM-DD HH:mm:ss")},exportData:function(){var t=this;if(/^[0-9]+?$/.test(t.form.init.data.limit))if(t.form.init.data.limit>1e4||t.form.init.data.limit<1)t.$message.error("导出条数应在[1~10000]内");else{var e=t.params.search.fieldName,a=t.params.search.search||"",n=t.form.init.data.offset,i=t.form.init.data.total,s=t.form.init.data.limit,r=t.params.search.startDate,o=t.params.search.endDate,c=t.params.exportUrl,l="".concat(t.BASE_URL).concat(c,"?search=").concat(a,"&fieldName=").concat(e,"&offset=").concat(n,"&limit=").concat(s,"&total=").concat(i,"&startDate=").concat(r,"&endDate=").concat(o);window.open(l,"_blank"),this.close()}else this.$message.error("导出条数请输入正整数")},update:function(){var t=this;t.parent.update()}}},C=_,H=(a("3e0e"),a("2877")),O=Object(H["a"])(C,y,w,!1,null,"fda4a51c",null),L=O.exports,N=new Y["a"](L),R=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.form.init.show?a("div",[a("a-modal",{attrs:{closable:!0,title:t.form.init.title,width:t.form.init.width,"mask-closable":!1},model:{value:t.form.init.show,callback:function(e){t.$set(t.form.init,"show",e)},expression:"form.init.show"}},["delete"===t.form.name?a("div",[t._v(" 确定删除？ ")]):a("a-form-model",{ref:"form",class:{views:"view"===t.form.name},attrs:{model:t.form.init.data,rules:t.form.init.rules,"label-col":{span:t.form.init.labelSpan||6},"wrapper-col":{span:t.form.init.wrapperSpan||18}}},[void 0!==t.form.init.data.limit?a("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"条数",prop:"limit"}},[a("a-input",{staticStyle:{width:"100%"},attrs:{maxLength:10},model:{value:t.form.init.data.limit,callback:function(e){t.$set(t.form.init.data,"limit",e)},expression:"form.init.data.limit"}})],1):t._e()],1),a("template",{slot:"footer"},["export"===t.form.name?a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.exportData()}}},[t._v("导出")]):t._e(),a("a-button",{on:{click:function(e){return t.clickCancel()}}},[t._v("关闭")])],1)],2)],1):t._e()},I=[],E={name:"AuditSystemOperationLogDialog",components:{},mixins:[s["a"]],filters:{convertSecurityRank:M["x"],convertTime:M["C"],convertAuditEventLogExceptionType:M["e"],convertNoticeType:M["v"],convertDisposeType:M["k"]},props:{},data:function(){return{zhCN:S["a"],spinning:!1,state:"",params:"",parent:"",form:{view:{title:"详情",width:750,request:"",show:!0,data:{},rules:{}},export:{title:"导出",width:420,request:"",show:!0,timeRange:[k()().subtract(1,"days").format("YYYY-MM-DD HH:mm:ss"),k()().format("YYYY-MM-DD HH:mm:ss")],ranges:{},data:{startDate:k()().subtract(1,"days").format("YYYY-MM-DD HH:mm:ss"),endDate:k()().format("YYYY-MM-DD HH:mm:ss"),limit:1,offset:0},rules:{}}}}},created:function(){this.showDialog(this.state,this.params)},methods:{beforeShowDialog:function(){},beforeSave:function(){},close:function(){this.form.init.show=!1},disabledDate:function(t){return t>k()().endOf("day")},dateChange:function(t){this.form.init.data.startDate=t[0].format("YYYY-MM-DD HH:mm:ss"),this.form.init.data.endDate=t[1].format("YYYY-MM-DD HH:mm:ss")},exportData:function(){var t=this;if(/^[0-9]+?$/.test(t.form.init.data.limit))if(t.form.init.data.limit>1e4||t.form.init.data.limit<1)t.$message.error("导出条数应在[1~10000]内");else{var e=t.params.search.fieldName,a=t.params.search.search||"",n=t.form.init.data.offset,i=t.form.init.data.total,s=t.form.init.data.limit,r=t.params.search.startDate,o=t.params.search.endDate,c=t.params.exportUrl,l="".concat(t.BASE_URL).concat(c,"?search=").concat(a,"&fieldName=").concat(e,"&offset=").concat(n,"&limit=").concat(s,"&total=").concat(i,"&startDate=").concat(r,"&endDate=").concat(o);window.open(l,"_blank"),this.close()}else this.$message.error("导出条数请输入正整数")},update:function(){var t=this;t.parent.update()}}},$=E,T=(a("e166"),Object(H["a"])($,R,I,!1,null,"6f7cfa5f",null)),U=T.exports,j=new Y["a"](U),G=a("0618"),A=a("e6e5"),J=[{title:"操作状态",scopedSlots:{customRender:"state"}},{title:"用户名",dataIndex:"operationUsername"},{title:"角色",dataIndex:"permissionGroupName"},{title:"登录IP",dataIndex:"ip"},{title:"操作模块",dataIndex:"module"},{title:"详情",dataIndex:"content"},{title:"操作时间",ellipsis:!0,scopedSlots:{customRender:"timestamp"}}],P=[{title:"操作状态",scopedSlots:{customRender:"state"}},{title:"用户名",dataIndex:"operationUsername"},{title:"角色",dataIndex:"permissionGroupName"},{title:"登录IP",dataIndex:"ip"},{title:"操作模块",dataIndex:"module"},{title:"描述",dataIndex:"details"},{title:"详情",dataIndex:"content"},{title:"操作时间",ellipsis:!0,dataIndex:"timestamp",scopedSlots:{customRender:"timestamp"}}],V=[{name:"用户名",value:"operationUsername"},{name:"角色",value:"permissionGroupName"},{name:"登录IP",value:"ip"},{name:"操作模块",value:"module"},{name:"详情",value:"content"}],z=[{name:"用户名",value:"operationUsername"},{name:"角色",value:"permissionGroupName"},{name:"登录IP",value:"ip"},{name:"操作模块",value:"module"},{name:"描述",value:"details"},{name:"详情",value:"content"}],q={1:{fieldNameList:V,columns:J,list:c,listDelete:m,dialog:N,exportUrl:"system-login-log/export-data",getRecord:d,dateValue:[k()().startOf("day"),k()()],search:{startDate:k()().startOf("day").format("YYYY-MM-DD HH:mm:ss"),endDate:k()().format("YYYY-MM-DD HH:mm:ss")}},2:{fieldNameList:z,columns:P,list:p,listDelete:v,dialog:j,exportUrl:"system-operation-log/export-data",getRecord:b,dateValue:[k()().startOf("day"),k()()],search:{startDate:k()().startOf("day").format("YYYY-MM-DD HH:mm:ss"),endDate:k()().format("YYYY-MM-DD HH:mm:ss")}}},B="as:m",F={name:"AuditSystemLog",mixins:[s["a"]],components:{BFixedTable:G["a"],BDateRange:A["a"]},filters:{convertTime:M["C"]},data:function(){return{readOnly:!1,permissionDeviceMenu:[],menuLists:[{id:1,value:1,menuName:"登录日志"},{id:2,value:2,menuName:"操作日志"}],userName:"",logCanDeleted:!1,menu:"",dialog:"",columns:"",tableList:"",deleteList:"",getRecord:"",exportUrl:"",loading:!1,fieldNameList:[],dateValue:[k()().subtract(1,"hours"),k()()],search:{startDate:k()().subtract(1,"hours").format("YYYY-MM-DD HH:mm:ss"),endDate:k()().format("YYYY-MM-DD HH:mm:ss")},table:{data:[],total:0},fieldList:[{name:"用户名",id:"name",value:""},{name:"登录IP",id:"loginIp",value:""},{name:"操作模块",id:"module",value:""},{name:"操作状态",id:"state",value:""}]}},created:function(){var t=this,e=JSON.parse(localStorage.getItem("system-log")),a=JSON.parse(localStorage.getItem("app.user"));this.userName=a.name,this.logCanDeleted=a.logCanDeleted,e.forEach((function(e){var a="";a=Number.parseInt(e.index),t.permissionDeviceMenu.push(a)})),this.menu=+sessionStorage.getItem(B)||Number.parseInt(this.permissionDeviceMenu[0]),this.switchMenu(this.menu)},watch:{$route:function(t,e){var a=this;e.path!==t.path&&this.$nextTick((function(){a.dialog&&a.dialog.close()}))},menu:function(t){var e=this,a=JSON.parse(localStorage.getItem("system-log"));a.forEach((function(a){Number.parseInt(a.index)==t&&(e.readOnly=JSON.parse(a.readonly))}))}},methods:{dateRangeChange1:function(t){this.search.startDate=t.dateStrings[0],this.search.endDate=t.dateStrings[1],this.dateValue=t.dateStrings},view:function(t){var e=this;this.getRecord?this.getRecord(t.id).then((function(t){var a=t.data;e.dialog.open({state:"view",parent:e,params:a})})):this.dialog.open({state:"view",parent:this,params:t})},exports:function(){this.dialog.open({state:"export",parent:this,params:{search:this.search,exportUrl:this.exportUrl}})},handleMenuChange:function(t){this.switchMenu(t.target.value)},switchMenu:function(t){this.menu=t;var e=q[this.menu];this.columns=e.columns,this.tableList=e.list,this.deleteList=e.listDelete,this.dialog=e.dialog,this.exportUrl=e.exportUrl,this.getRecord=e.getRecord,this.fieldNameList=e.fieldNameList,this.table.data=[],this.table.total=0,sessionStorage.setItem(B,this.menu),this.tableList&&this.resetSearch()},update:function(t,e){var a=this;this.page=t||this.page,this.pageSize=e||this.pageSize,this.loading=!0,a.table.total=0,a.table.data=[],this.tableList(this.page,this.pageSize,this.searchParams,this.table.total).then((function(t){var e=t.data;e&&(a.table.total=null==e.total?0:e.total,a.table.data=e.rows)})).finally((function(){a.loading=!1}))},choseFieldName:function(){this.search.search=""},clickSearch1:function(){this.search.startDate=k()().startOf("day").format("YYYY-MM-DD HH:mm:ss"),this.search.endDate=k()().format("YYYY-MM-DD HH:mm:ss"),this.dateValue=[k()().startOf("day"),k()()],this.clickSearch(1)},searchClick:function(){var t={};if(this.search.searchs="",this.fieldList.forEach((function(e){""!=e.value&&void 0!=e.value&&(t[e.id]=e.value)})),Object.keys(t).length>0){var e=JSON.stringify(t),a=encodeURIComponent(e);this.search.searchs=a}this.clickSearch(1)},resetSearch:function(){for(var t in this.fieldList.forEach((function(t){t.value=""})),this.search)"startDate"===t||"endDate"===t?(this.search["startDate"]=k()().startOf("day").format("YYYY-MM-DD HH:mm:ss"),this.search["endDate"]=k()().format("YYYY-MM-DD HH:mm:ss"),this.dateValue=[k()().startOf("day"),k()()]):"searchs"==t&&(this.search["searchs"]="");this.searchClick(),this.$forceUpdate()},deleteLog:function(){var t=this,e=t.search.search||"",a=t.search.startDate,n=t.search.endDate;t.$confirm({content:"此操作将删除符合查询条件的所有日志内容，请确认是否删除！",okText:"确认",cancelText:"取消",onOk:function(){t.loading=!0,t.deleteList(e,a,n).then((function(e){"SUCCESS"==e.state&&(t.$message.success(e.msg),t.update(),t.loading=!1)})).catch((function(){t.loading=!1}))},onCancel:function(){}})}},destroyed:function(){sessionStorage.removeItem(B)},beforeDestroy:function(){this.dialog&&this.dialog.close()}},K=F,Q=(a("6adf"),Object(H["a"])(K,n,i,!1,null,"1bcb6cf2",null));e["default"]=Q.exports},"6adf":function(t,e,a){"use strict";a("4b5d")},e166:function(t,e,a){"use strict";a("126f")}}]);