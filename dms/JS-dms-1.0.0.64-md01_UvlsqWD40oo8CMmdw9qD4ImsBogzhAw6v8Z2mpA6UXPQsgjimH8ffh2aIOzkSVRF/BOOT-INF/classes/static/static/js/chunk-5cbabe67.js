(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5cbabe67"],{"0618":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-table",{ref:"table",staticClass:"AStockOutDetailTable",attrs:{columns:e.columns,dataSource:e.data,rowKey:e.rowKey,bordered:e.bordered,loading:e.loading,size:e.size,"row-selection":e.rowSelection,pagination:{current:e.page,pageSize:e.pageSize,total:e.total,pageSizeOptions:e.pageSizeOptions,onChange:e.onPageChange,onShowSizeChange:e.onShowSizeChange,showSizeChanger:e.showSizeChanger,showQuickJumper:e.showQuickJumper,hideOnSinglePage:e.hideOnSinglePage,showTotal:e.showTotal,size:e.size,showLessItems:e.showLessItems},scroll:{y:e.tableHeight}},scopedSlots:e._u([{key:"number",fn:function(t,a,n){return e.showIndex?[e._v(" "+e._s(n+1)+" ")]:void 0}},e._l(Object.keys(e.$scopedSlots).filter((function(e){return"expandedRowRender"!==e})),(function(t){return{key:t,fn:function(a,n,i){return[e._t(t,null,null,{text:a,record:n,index:i})]}}})),{key:e.$scopedSlots.expandedRowRender?"expandedRowRender":"",fn:function(t,a,n,i){return[e._t(e.$scopedSlots.expandedRowRender?"expandedRowRender":"",null,null,{record:t,index:a,indent:n,expanded:i})]}}],null,!0)},[e._l(Object.keys(e.$slots),(function(t){return a("template",{slot:t},[e._t(t)],2)}))],2)],1)},i=[],s=(a("a9e3"),a("9b10")),o={name:"BFixedTable",mixins:[s["a"]],props:{columns:{type:Array,required:!0},pageSizeOptions:{type:Array,default:function(){return["10","20","50","100","200"]}},showIndex:{type:Boolean,default:!0},rowKey:String,tableHeight:{type:Number,default:550},beautyScroller:{type:Boolean,default:!0},data:{type:Array,default:function(){return[]}},total:{type:Number,default:0},bordered:{type:Boolean,default:!0},initPage:{type:Number,default:1},initPageSize:{type:Number,default:10},showOuterBorder:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},showTotal:{type:Function,default:function(e){return"总共".concat(e,"条")}},showQuickJumper:{type:Boolean,default:!0},showSizeChanger:{type:Boolean,default:!0},hideOnSinglePage:{type:Boolean,default:!1},showLessItems:{type:Boolean,default:!1},size:{type:String,default:"default"},rootData:{type:Object,default:function(){}},rowSelection:{type:Object,default:function(){return null}}},data:function(){return{page:1,pageSize:10}},mounted:function(){this.fixedHeight(),this.updateData(),this.addIndex(),this.beautyScroller&&this.beautyScroll(),this.showOuterBorder&&this.setOutBorder(),this.page=this.initPage,this.pageSize=this.initPageSize},watch:{initPage:function(e){this.page!==e&&(this.page=e,this.updateData())},initPageSize:function(e){this.pageSize!==e&&(this.pageSize=e,this.updateData())},columns:function(){this.addIndex()},total:function(){this.fixedHeight()},tableHeight:function(){this.fixedHeight()}},methods:{addIndex:function(){this.showIndex&&this.columns.length>0&&"序号"!==this.columns[0].title&&this.columns.unshift({title:"序号",scopedSlots:{customRender:"number"},width:80})},fixedHeight:function(){var e=this,t=this.$refs.table.$el;this.total>0?this.modifyStyleByClass(t,"ant-table-body",{"min-height":"".concat(this.tableHeight,"px"),"max-height":"".concat(this.tableHeight,"px")}):(this.modifyStyleByClass(t,"ant-table-body",{"min-height":"0px","max-height":"".concat(this.tableHeight,"px")}),this.$nextTick((function(){e.modifyStyleByClass(t,"ant-table-placeholder",{"min-height":"".concat(e.tableHeight,"px"),"max-height":"".concat(e.tableHeight,"px")})})))},setOutBorder:function(){var e;null===(e=this.$refs.table.$el.classList)||void 0===e||e.add("ant-card-bordered")},beautyScroll:function(){var e=this.$refs.table.$el.querySelector(".ant-table-hide-scrollbar");e&&(e.classList.add("beauty-scroll"),e.style["margin-bottom"]="",e.style["padding-bottom"]="",e.style["min-width"]="");var t=this.$refs.table.$el.querySelector(".ant-table-body");null===t||void 0===t||t.classList.add("beauty-scroll")},onPageChange:function(e,t){this.page=e,this.pageSize=t,this.updateData()},onShowSizeChange:function(e,t){this.page=1,this.pageSize=t,this.updateData()},updateData:function(){this.$emit("change",{page:this.page,pageSize:this.pageSize,rootData:this.rootData})}}},r=o,c=(a("156c"),a("2877")),l=Object(c["a"])(r,n,i,!1,null,"eb2634aa",null);t["a"]=l.exports},"0647":function(e,t,a){"use strict";a("1cc0")},"156c":function(e,t,a){"use strict";a("1bbf")},"1bbf":function(e,t,a){},"1cc0":function(e,t,a){},"1d67":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-card",{staticStyle:{"margin-top":"30px"}},[a("div",{staticClass:"search"},[a("div",{staticClass:"title"},[e._v("查询条件")]),a("div",{staticClass:"content"},[a("span",[e._v("关键字:")]),a("span",{staticClass:"inner"},[a("a-input",{staticClass:"i-width",attrs:{maxLength:64,placeholder:"请输入角色名称"},on:{pressEnter:e.clickSearch},model:{value:e.search.search,callback:function(t){e.$set(e.search,"search",t)},expression:"search.search"}})],1),a("span",{staticClass:"outer"},[a("a-button",{staticClass:"button",attrs:{type:"primary"},on:{click:e.clickSearch}},[e._v("查询")])],1),a("span",{staticClass:"outer"},[a("a-button",{staticClass:"button",on:{click:e.resetSearch}},[e._v("重置")])],1)])]),a("div",{staticClass:"body"},[a("div",{staticClass:"buttons"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.createRole()}}},[e._v("新建")])],1),a("a-row",{staticClass:"table"},[a("a-col",{staticStyle:{padding:"0 12px"},attrs:{xl:24,lg:24,md:24,sm:24,xs:24}},[a("b-fixed-table",{attrs:{columns:e.columns,rowKey:"name",data:e.permissionGroups.data,loading:e.loading,total:e.permissionGroups.total,"init-page":e.page},on:{change:e.tableParamChanged},scopedSlots:e._u([{key:"operations",fn:function(t){var n=t.record;return[1!=n.isDefault&&n.name!=e.groupName?a("span",[a("span",{staticClass:"oper oper-margin",on:{click:function(t){return e.modifyRole(n)}}},[e._v("修改")])]):e._e(),1!=n.isDefault&&n.name!=e.groupName?a("span",{staticClass:"oper oper-margin red"},[a("span",{on:{click:function(t){return e.deleteRole(n)}}},[e._v("删除")])]):e._e()]}}])})],1)],1)],1)])],1)},i=[],s=a("0618"),o=a("1da1"),r=(a("96cf"),a("99af"),a("b775"));function c(e,t,a){return l.apply(this,arguments)}function l(){return l=Object(o["a"])(regeneratorRuntime.mark((function e(t,a,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(r["f"])("system/permission-groups?offset=".concat((t-1)*a,"&limit=").concat(a).concat(n),r["a"].GET));case 1:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}function u(e){return d.apply(this,arguments)}function d(){return d=Object(o["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(r["f"])("system/permission-group",r["a"].POST,t));case 1:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function p(){return h.apply(this,arguments)}function h(){return h=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(r["f"])("system/permission-group/all",r["a"].GET));case 1:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function m(e){return f.apply(this,arguments)}function f(){return f=Object(o["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(r["f"])("system/permission-group",r["a"].PUT,t));case 1:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}function g(e){return b.apply(this,arguments)}function b(){return b=Object(o["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t.id,e.abrupt("return",Object(r["f"])("system/permission-group/".concat(a),r["a"].DELETE));case 2:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}var y=a("c2f2"),w=a("8cff"),v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.form.init.show?a("div",[a("a-modal",{attrs:{closable:!0,footer:"view"===e.form.name?null:void 0,title:e.form.init.title,width:e.form.init.width,"mask-closable":!1},model:{value:e.form.init.show,callback:function(t){e.$set(e.form.init,"show",t)},expression:"form.init.show"}},["delete"===e.form.name?a("div",[e._v(" "+e._s(e.form.init.msg)+" ")]):a("a-form-model",{ref:"form",attrs:{model:e.form.init.data,rules:e.form.init.rules,"label-col":{span:4},"wrapper-col":{span:18}}},[a("a-form-model-item",{attrs:{label:"角色名称",prop:"name"}},[a("a-input",{staticClass:"dialog-input-height",attrs:{disabled:!e.form.init.isCreate,placeholder:"请输入名称",maxLength:20},model:{value:e.form.init.data.name,callback:function(t){e.$set(e.form.init.data,"name",t)},expression:"form.init.data.name"}})],1),a("a-form-model-item",{attrs:{label:"上级角色",prop:"parentId"}},[a("a-select",{attrs:{disabled:!e.form.init.isCreate,placeholder:"请选择"},on:{change:e.choseRole},model:{value:e.form.init.data.parentId,callback:function(t){e.$set(e.form.init.data,"parentId",t)},expression:"form.init.data.parentId"}},e._l(e.roleList,(function(t,n){return a("a-select-option",{key:n,attrs:{value:t.id,text:t.name}},[e._v(e._s(t.name))])})),1)],1),a("a-form-model-item",{attrs:{label:"权限列表"}},[a("a-tree",{attrs:{checkable:"","show-line":"","tree-data":e.permissionList,replaceFields:{children:"subPermissions",title:"name",key:"treeId"}},on:{check:e.onCheck},scopedSlots:e._u([{key:"custom",fn:function(t){return[a("span",[e._v(e._s(t.name))]),t.subPermissions.length<1?a("span",{staticStyle:{"margin-left":"200px","z-index":"999"},on:{click:function(a){return e.choseReadonly(t)}}},[1==t.readonly?a("span",{staticClass:"readonlyStyle"},[e._v("只读")]):e._e(),0==t.readonly?a("span",{staticClass:"readonlyStyle"},[e._v("读写")]):e._e()]):e._e()]}}],null,!1,3566565932),model:{value:e.checkedKeys,callback:function(t){e.checkedKeys=t},expression:"checkedKeys"}})],1)],1),a("template",{slot:"footer"},[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.clickSave()}}},[e._v(e._s(e.okText||e.form.init.okText))]),a("a-button",{on:{click:function(t){return e.clickCancel()}}},[e._v(e._s(e.cancelText||e.form.init.cancelText))])],1)],2)],1):e._e()},x=[],S=(a("b0c0"),a("d3b7"),a("159b"),a("a00a")),k={name:"RoleDialog",mixins:[y["a"]],comments:{},filters:{},props:{},data:function(){return{roleLength:0,state:"",params:"",parent:"",okText:"",cancelText:"",roleList:[{id:"",name:"请选择"}],permissionList:[],checkedKeys:[],form:{checkedKeyList:[],create:{title:"新建角色",width:1200,isCreate:!0,request:u,show:!0,okText:"确定",cancelText:"取消",msg:"",data:{id:"",name:"",parentId:"",selectedPermissions:[]},rules:{name:S["a"].name,sRole:S["a"].select,parentId:S["a"].select}},modify:{title:"修改角色",width:1200,request:m,show:!0,okText:"确定",cancelText:"取消",msg:"",data:{id:"",parentId:"",name:"",selectedPermissions:[]},rules:{}},view:{title:"查看",width:1200,request:"",show:!0,okText:"确定",cancelText:"取消",msg:"",data:{id:"",parentId:"",name:"",selectedPermissions:[]},rules:{}},delete:{title:"删除角色",width:420,isDelete:!0,request:g,show:!0,okText:"确定",cancelText:"取消",msg:"确定删除该角色？",data:{id:""},rules:{}}}}},created:function(){var e=this;p().then((function(t){e.roleList=t.data})),"delete"===e.state?e.showDialog(e.state,e.params):"create"!==e.state&&"modify"!==e.state&&"view"!==e.state||e.showDialog(e.state,e.params),"modify"!=e.state&&"view"!==e.state||(null!=e.params.parentId&&void 0!=e.params.parentId&&""!=e.params.parentId||(e.params.parentId=-1),Object(r["f"])("system/permission-group/".concat(e.params.id,"?parentId=").concat(e.params.parentId),r["a"].GET).then((function(t){var a=t.data.permissions;e.permissionList=a,e.roleLength=0;var n=0;a.forEach((function(t){t.subPermissions.length>0?t.subPermissions.forEach((function(t){t.subPermissions.length>0?t.subPermissions.forEach((function(t){t.scopedSlots={title:"custom"},n+=1,1==t.selected&&(e.form.init.data.selectedPermissions.push(t),e.checkedKeys.push(t.treeId))})):(1==t.selected&&(e.form.init.data.selectedPermissions.push(t),e.checkedKeys.push(t.treeId)),t.scopedSlots={title:"custom"},n+=1)})):(t.scopedSlots={title:"custom"},n+=1,1==t.selected&&(e.form.init.data.selectedPermissions.push(t),e.checkedKeys.push(t.treeId)))})),e.roleLength=n})))},mounted:function(){},methods:{onCheck:function(e,t){var a=this;this.form.init.data.selectedPermissions=[],t.checkedNodesPositions.length>0&&t.checkedNodesPositions.forEach((function(e){var t=e.node;t.data.props.subPermissions.length<1&&a.form.init.data.selectedPermissions.push(t.data.props.dataRef)}))},choseReadonly:function(e){1==e.dataRef.defaulted?this.$message.error("该权限默认为只读，不可改"):(e.dataRef.readonly=!e.dataRef.readonly,this.$forceUpdate())},beforeShowDialog:function(){},beforeSave:function(e){if("modify"==this.form.name||"create"==this.form.name){if(e.selectedPermissions.length<1)return this.$message.error("请选择权限"),1;if(e.selectedPermissions.length>=this.roleLength)return this.$message.error("子角色权限不得跟管理员权限相同"),1}},close:function(){this.form.init.show=!1},update:function(){var e=this;e.parent.update()},choseRole:function(e){var t=this;t.checkedKeys=[],t.form.init.data.selectedPermissions=[],Object(r["f"])("system/permission-group/-1?parentId=".concat(e),r["a"].GET).then((function(e){var a=e.data.permissions;t.roleLength=0;var n=function e(a){a.forEach((function(a){a.scopedSlots={title:"custom"},a.subPermissions&&a.subPermissions.length>0?e(a.subPermissions):t.roleLength+=1}))};n(a),t.permissionList=a}))}}},_=k,R=(a("0647"),a("2877")),C=Object(R["a"])(_,v,x,!1,null,"6bffb826",null),P=C.exports,O=new w["a"](P),z=[{title:"角色名称",dataIndex:"name"},{title:"操作",scopedSlots:{customRender:"operations"}}],T={name:"RoleManage",mixins:[y["a"]],components:{BFixedTable:s["a"]},data:function(){return{groupName:"",dialog:O,columns:z,loading:!1,permissionGroups:{data:[],total:0}}},mounted:function(){},created:function(){this.groupName=JSON.parse(localStorage.getItem("app.user")).groupName},methods:{createRole:function(){var e=this;e.dialog.open({state:"create",params:{id:-1},parent:e})},modifyRole:function(e){var t=this;t.$confirm({content:"修改角色权限会导致相关联用户强制掉线，请谨慎操作！",okText:"确认",cancelText:"取消",onOk:function(){t.dialog.open({state:"modify",params:e,parent:t})},onCancel:function(){}})},ViewRole:function(e){var t=this;t.dialog.open({state:"view",params:e,parent:t})},deleteRole:function(e){var t=this;t.dialog.open({state:"delete",parent:t,params:{id:e.id}})},update:function(e,t){var a=this;this.page=e||this.page,this.pageSize=t||this.pageSize,a.loading=!0,c(this.page,this.pageSize,this.searchParams).then((function(e){var t=e.data;t&&(a.permissionGroups.total=t.total,a.permissionGroups.data=t.rows,a.loading=!1)})).catch((function(){a.loading=!1}))}},destroyed:function(){},watch:{$route:function(e,t){var a=this;t.path!==e.path&&this.$nextTick((function(){a.dialog&&a.dialog.close()}))}},beforeDestroy:function(){this.dialog&&this.dialog.close()}},I=T,$=(a("5096"),Object(R["a"])(I,n,i,!1,null,"8a10c570",null));t["default"]=$.exports},5096:function(e,t,a){"use strict";a("e3d0")},e3d0:function(e,t,a){}}]);