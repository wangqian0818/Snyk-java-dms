(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-28140dfb"],{4954:function(t,a,s){"use strict";s.r(a);var e=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",[s("div",{staticClass:"page-menu"}),s("a-spin",{attrs:{spinning:t.spinning,tip:"正在查询，请稍后！"}},[s("a-card",{staticClass:"container"},[s("div",{staticClass:"search"},[s("div",{staticClass:"title"},[t._v("查询条件")]),s("div",{ref:"search",staticClass:"content"},[s("span",{staticStyle:{"margin-left":"15px"}},[t._v("起止时间:")]),s("span",{staticClass:"inner"},[s("a-range-picker",{attrs:{"show-time":{format:"HH:mm"},format:"YYYY-MM-DD HH:mm:ss",ranges:t.ranges,"disabled-date":t.disabledDate,placeholder:["开始时间","结束时间"],"allow-clear":!1},model:{value:t.timeRange,callback:function(a){t.timeRange=a},expression:"timeRange"}})],1),s("span",{staticClass:"outer"},[t._v("ip:")]),s("span",{staticClass:"inner"},[s("a-input",{staticClass:"i-width",attrs:{maxLength:64,placeholder:"请输入查询ip"},on:{pressEnter:t.clickSearch1},model:{value:t.search.search,callback:function(a){t.$set(t.search,"search",a)},expression:"search.search"}})],1),s("span",{staticClass:"outer"},[s("a-button",{staticClass:"button",attrs:{type:"primary"},on:{click:function(a){return t.clickSearch1(1)}}},[t._v("查询")])],1),s("span",{staticClass:"outer"},[s("a-button",{staticClass:"button",on:{click:t.resetSearch}},[t._v("重置")])],1)])]),s("div",{staticClass:"body"},[s("a-row",{staticClass:"table",attrs:{gutter:[20,20]}},[s("a-col",{attrs:{span:12}},[s("div",{staticClass:"canvas",staticStyle:{height:"760px"}},["edge"==t.clicktype?s("div",{staticStyle:{padding:"10px"}},[s("span",{staticClass:"infoClass"},[t._v("边线信息")]),t.clickData.length<1?s("div",[s("span",{staticStyle:{"font-size":"12px",margin:"10px"}},[t._v("暂无数据，请先选择右侧边线或节点")])]):s("div",[s("div",{staticClass:"tableClass"},[s("div",{staticStyle:{width:"20%"}},[t._v("源IP")]),["SBLL"==t.dataList.logType?s("div",{staticStyle:{width:"20%"}},[t._v("目的IP")]):s("div",{staticStyle:{width:"20%"}},[t._v("服务名称")])],s("div",{staticStyle:{width:"12%"}},[t._v("输入字节")]),s("div",{staticStyle:{width:"12%"}},[t._v("输出字节")]),s("div",{staticStyle:{width:"12%"}},[t._v("总字节数")]),"SBLL"==t.dataList.logType?[s("div",{staticStyle:{width:"12%"}},[t._v("总包数")])]:t._e(),s("div",{staticStyle:{width:"12%"}},[t._v("总会话数")])],2),s("div",{staticClass:"tableClass"},[s("div",{staticStyle:{width:"20%"}},[t._v(t._s(t.clickData.sip))]),s("div",{staticStyle:{width:"20%"}},[t._v(t._s(t.clickData.dip))]),s("div",{staticStyle:{width:"12%"}},[t._v(t._s(t.clickData["down-bytes"]))]),s("div",{staticStyle:{width:"12%"}},[t._v(t._s(t.clickData["up-bytes"]))]),s("div",{staticStyle:{width:"12%"}},[t._v(t._s(t.clickData.bytes))]),"SBLL"==t.dataList.logType?[s("div",{staticStyle:{width:"12%"}},[t._v(t._s(t.clickData.pkts))])]:t._e(),s("div",{staticStyle:{width:"12%"}},[t._v(t._s(t.clickData.sessionNum))])],2)])]):"node"==t.clicktype?s("div",{staticStyle:{padding:"10px"}},[s("span",{staticClass:"infoClass"},[t._v("节点信息")]),t.clickData.length<1?s("div"):s("div",[s("div",{staticClass:"tableClass"},[s("div",{staticStyle:{width:"20%"}},[t._v("节点名称")]),s("div",{staticStyle:{width:"15%"}},[t._v("输入字节数")]),"SBLL"==t.dataList.logType?[s("div",{staticStyle:{width:"15%"}},[t._v("输入包数")])]:t._e(),s("div",{staticStyle:{width:"15%"}},[t._v("输出字节数")]),"SBLL"==t.dataList.logType?[s("div",{staticStyle:{width:"15%"}},[t._v("输出包数")])]:t._e(),s("div",{staticStyle:{width:"15%"}},[t._v("会话数")])],2),s("div",{staticClass:"tableClass"},[s("div",{staticStyle:{width:"20%"}},[t._v(t._s(t.clickData.name))]),s("div",{staticStyle:{width:"15%"}},[t._v(t._s(t.clickData["down-bytes"]))]),"SBLL"==t.dataList.logType?[s("div",{staticStyle:{width:"15%"}},[t._v(t._s(t.clickData["down-pkts"]))])]:t._e(),s("div",{staticStyle:{width:"15%"}},[t._v(t._s(t.clickData["up-bytes"]))]),"SBLL"==t.dataList.logType?[s("div",{staticStyle:{width:"15%"}},[t._v(t._s(t.clickData["up-pkts"]))])]:t._e(),s("div",{staticStyle:{width:"15%"}},[t._v(t._s(t.clickData.sessionNum))])],2),t.clickData.portList?s("div",[s("div",{staticStyle:{height:"50px","line-height":"50px","font-size":"12px",color:"#0ab1c5"}},[0==t.clickData.category?s("span",[t._v("服务名称信息")]):1==t.clickData.category?s("span",[t._v("源IP信息")]):t._e()]),s("div",{staticClass:"tableClass1"},[s("a-table",{staticClass:"AStockOutDetailTable1",attrs:{pagination:!1,rowKey:"dport",columns:t.portColumns,"data-source":t.clickData.portList},scopedSlots:t._u([{key:"name",fn:function(a){return[null!=a.name?s("span",{attrs:{title:a.name}},[t._v(t._s(a.name))]):s("span",[t._v("-")])]}},{key:"bytes",fn:function(a){return[null!=a.bytes?s("span",{attrs:{title:a.bytes}},[t._v(t._s(a.bytes))]):s("span",[t._v("-")])]}},{key:"downBytes",fn:function(a){return[null!=a["down-bytes"]?s("span",{attrs:{title:a["down-bytes"]}},[t._v(t._s(a["down-bytes"]))]):s("span",[t._v("-")])]}},{key:"upBytes",fn:function(a){return[null!=a["up-bytes"]?s("span",{attrs:{title:a["up-bytes"]}},[t._v(t._s(a["up-bytes"]))]):s("span",[t._v("-")])]}},{key:"sessionNum",fn:function(a){return[null!=a.sessionNum?s("span",{attrs:{title:a.sessionNum}},[t._v(t._s(a.sessionNum))]):s("span",[t._v("-")])]}}],null,!1,887573112)})],1)]):t._e()])]):t._e()])]),s("a-col",{attrs:{span:12}},[s("div",{staticClass:"canvas"},[s("graph",{attrs:{width:"100%",data:t.dataList,height:750},on:{clickChart:t.clickChart}})],1)])],1)],1)])],1)],1)},i=[],c=(s("ac1f"),s("841c"),s("c2f2")),n=s("c1df"),l=s.n(n),r=s("1da1"),o=(s("96cf"),s("b775"));function d(t){return p.apply(this,arguments)}function p(){return p=Object(r["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(o["f"])("traffic-analysis/nodes",o["a"].GET,a));case 1:case"end":return t.stop()}}),t)}))),p.apply(this,arguments)}var h=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"chart"},[s("div",{style:{width:"Number"===typeof t.width?t.width+"px":t.width,height:t.height+"px"}},[s("v-chart",{ref:"v_chart",staticStyle:{width:"100%",height:"100%"},attrs:{autoresize:"",option:t.options},on:{click:t.onClick}})],1)])},u=[],m=(s("a9e3"),s("b0c0"),s("d81d"),{name:"BStackBar",props:{data:{type:Object,default:function(){}},width:{type:[Number,String],default:340},height:{type:Number,default:130}},data:function(){return{}},mounted:function(){},methods:{onClick:function(t){"node"==t.dataType?this.$emit("clickChart",t,"node"):"edge"==t.dataType&&this.$emit("clickChart",t,"edge")}},created:function(){},watch:{},computed:{options:function(){var t=this;return{title:{text:"业务流量拓扑",top:"bottom",left:"left"},tooltip:{formatter:function(a){var s="";return"edge"==a.dataType?(s="总字节数："+a.data.bytes+"<br/>总会话数："+a.data.sessionNum+"<br/>",s):"node"==a.dataType&&"SBLL"==t.data.type?(s="节点名称："+a.data.name+"<br/>输入字节数："+a.data["down-bytes"]+"<br/>输入包数："+a.data["down-pkts"]+"<br/>输出字节数："+a.data["up-bytes"]+"<br/>输出包数："+a.data["up-pkts"]+"<br/>会话数："+a.data.sessionNum+"<br/>",s):"node"==a.dataType&&"SBACCESS"==t.data.type&&0==a.data.category?(s="节点名称："+a.data.name+"<br/>输出字节数："+a.data["up-bytes"]+"<br/>会话数："+a.data.sessionNum+"<br/>",s):"node"==a.dataType&&"SBACCESS"==t.data.type&&1==a.data.category?(s="节点名称："+a.data.name+"<br/>输入字节数："+a.data["down-bytes"]+"<br/>会话数："+a.data.sessionNum+"<br/>",s):void 0}},legend:[{data:this.data.categories.map((function(t){return t.name}))}],series:[{type:"graph",layout:"none",data:this.data.nodes,links:this.data.links,categories:this.data.categories,roam:!0,label:{show:!0,position:"right",formatter:"{b}"},edgeSymbol:["circle","arrow"],edgeSymbolSize:5,lineStyle:{color:"source",curveness:.2},emphasis:{focus:"adjacency",lineStyle:{width:10}}}]}}}}),y=m,v=s("2877"),f=Object(v["a"])(y,h,u,!1,null,"7e414568",null),g=f.exports,b=[],_={name:"flowAnalyse",components:{graph:g},mixins:[c["a"]],comments:{},props:{},data:function(){return{readOnly:"false",loading:!1,spinning:!1,exportUrl:"",ranges:{},timeRange:[l()().subtract(1,"hours"),l()()],search:{search:"",startDate:l()().subtract(1,"hours").format("YYYY-MM-DD HH:mm:ss"),endDate:l()().format("YYYY-MM-DD HH:mm:ss")},dataList:{nodes:[],links:[],categories:[],logType:""},clickData:[],clicktype:"edge",portColumns:b}},filters:{},created:function(){this.update()},watch:{$route:function(t,a){var s=this;a.path!==t.path&&this.$nextTick((function(){s.dialog&&s.dialog.close()}))}},computed:{},mounted:function(){},methods:{disabledDate:function(t){return t>l()().endOf("day")},moment:l.a,afterClearSearchParams:function(){this.timeRange=[l()().subtract(1,"hours"),l()()]},beforeClickSearch:function(){this.search.startDate=this.timeRange[0].format("YYYY-MM-DD HH:mm:ss"),this.search.endDate=this.timeRange[1].format("YYYY-MM-DD HH:mm:ss")},resetSearch:function(){for(var t in this.search)"startDate"===t||"endDate"===t?(this.search["startDate"]=l()().subtract(1,"hours").format("YYYY-MM-DD HH:mm:ss"),this.search["endDate"]=l()().format("YYYY-MM-DD HH:mm:ss"),this.timeRange=[l()().subtract(1,"hours"),l()()]):this.search[t]="";this.afterClearSearchParams(),this.buildSearchParams(),this.update(1)},update:function(){var t=this;if(this.spinning=!0,this.dataList={nodes:[],links:[],categories:[],logType:""},!l()(this.timeRange[0]).isSame(this.timeRange[1],"day"))return this.$message.error("起始时间不得跨天"),void(this.spinning=!1);var a={startDate:this.timeRange[0].format("YYYY-MM-DD HH:mm:ss"),endDate:this.timeRange[1].format("YYYY-MM-DD HH:mm:ss"),search:this.search.search};d(a).then((function(a){t.spinning=!1,a&&a.data&&(t.dataList=a.data)})).catch((function(){t.spinning=!1}))},clickChart:function(t,a){this.clickData=[],this.portColumns=[],this.clicktype=a,this.clickData=t.data,0==this.clickData.category?this.portColumns=[{title:"服务名称",ellipsis:!0,scopedSlots:{customRender:"name"}},{title:"字节数",ellipsis:!0,scopedSlots:{customRender:"bytes"}},{title:"输入字节",ellipsis:!0,scopedSlots:{customRender:"downBytes"}},{title:"输出字节",ellipsis:!0,scopedSlots:{customRender:"upBytes"}},{title:"会话",width:"8%",ellipsis:!0,scopedSlots:{customRender:"sessionNum"}}]:1==this.clickData.category&&(this.portColumns=[{title:"源IP",ellipsis:!0,scopedSlots:{customRender:"name"}},{title:"字节数",ellipsis:!0,scopedSlots:{customRender:"bytes"}},{title:"输入字节",ellipsis:!0,scopedSlots:{customRender:"downBytes"}},{title:"输出字节",ellipsis:!0,scopedSlots:{customRender:"upBytes"}},{title:"会话",width:"8%",ellipsis:!0,scopedSlots:{customRender:"sessionNum"}}])},clickSearch1:function(t){this.clickData=[],this.clicktype="edge",t?this.clickSearch(1):this.clickSearch}},destroyed:function(){},beforeDestroy:function(){this.dialog&&this.dialog.close()}},S=_,k=(s("a654"),Object(v["a"])(S,e,i,!1,null,"1c470829",null));a["default"]=k.exports},a654:function(t,a,s){"use strict";s("fc6c")},fc6c:function(t,a,s){}}]);