(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-439dd658"],{"2a03":function(t,e,a){"use strict";a.r(e);var i,o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("bdata-show",{attrs:{columns:t.columns,rowKey:"id",data:t.table.data,total:t.table.total,depatch:!0,loading:t.loading,readOnly:t.readOnly,searchs:t.search,importDataUrl:t.importDataUrl,exportDataUrl:t.exportDataUrl,templateUrl:t.templateUrl,"init-page":t.page,activeKeyFlag:"no"},on:{change:t.tableParamChanged,create:t.openDialog,handleImportChange:t.handleImportChange,batchDelete:t.batchDelete},scopedSlots:t._u([{key:"search",fn:function(){return[a("div",[a("span",{staticClass:"inner"},[a("a-input",{staticClass:"i-width",attrs:{maxLength:64,placeholder:"请输入策略名称"},model:{value:t.search.name,callback:function(e){t.$set(t.search,"name",e)},expression:"search.name"}})],1),a("span",{staticClass:"outer"},[a("a-button",{staticClass:"button",attrs:{type:"primary"},on:{click:t.update}},[t._v("查询")])],1),a("span",{staticClass:"outer"},[a("a-button",{staticClass:"button",on:{click:t.resetUpdate}},[t._v("重置")])],1)])]},proxy:!0},{key:"securityRank",fn:function(e){var i=e.record;return[a("span",[t._v(t._s(t._f("convertSecurityRank")(i.securityRank)))])]}},{key:"codeFormat",fn:function(e){var i=e.record;return[a("span",[t._v(t._s(t._f("convertCodeFormatState")(i.codeFormat)))])]}},{key:"execAction",fn:function(e){var i=e.record;return[a("span",[t._v(t._s(t._f("convertExecAction")(i.execAction)))])]}},{key:"type",fn:function(e){var i=e.record;return[a("span",[t._v(t._s(t._f("convertStrategyList")(i.type)))])]}},{key:"operations",fn:function(e){var i=e.record;return[a("span",{staticClass:"oper",on:{click:function(e){return t.contentView(i.id)}}},[t._v("查看详情")]),3!=t.user.type?[t.readOnly?t._e():a("span",{staticClass:"oper-margin"},[a("span",{staticClass:"oper",on:{click:function(e){return t.contentModify(i.id)}}},[t._v("修改")])]),t.readOnly?t._e():a("span",{staticClass:"oper-margin"},[a("span",{staticClass:"oper red",on:{click:function(e){return t.contentDelete(i.id)}}},[t._v("删除")])])]:t._e()]}}])}),a("a-modal",{attrs:{title:t.title,closable:!0,"mask-closable":!1,"confirm-loading":t.confirmLoading,footer:"view"===t.dialogType?null:void 0},on:{cancel:t.clickCancel,ok:t.saveClick},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},["delete"===t.dialogType?a("div",[t._v("确定删除？")]):"create"==t.dialogType||"modify"==t.dialogType||"view"==t.dialogType?a("a-form-model",{ref:"form",attrs:{model:t.form.data,rules:t.form.rules,"label-col":{span:t.form.labelSpan||8},"wrapper-col":{span:t.form.wrapperSpan||16}}},[void 0!==t.form.data.name?a("a-form-model-item",{attrs:{label:"名称",prop:"name"}},[a("a-input",{staticClass:"dialog-input-height",attrs:{disabled:"create"!==t.dialogType,placeholder:"请输入名称",maxLength:20},model:{value:t.form.data.name,callback:function(e){t.$set(t.form.data,"name",e)},expression:"form.data.name"}})],1):t._e(),void 0!==t.form.data.execAction?a("a-form-model-item",{attrs:{label:"执行动作",prop:"execAction"}},[a("a-select",{attrs:{disabled:"view"==t.dialogType,placeholder:"请选择"},model:{value:t.form.data.execAction,callback:function(e){t.$set(t.form.data,"execAction",e)},expression:"form.data.execAction"}},[a("a-select-option",{attrs:{value:""}},[t._v("请选择")]),a("a-select-option",{attrs:{value:1}},[t._v("允许")]),a("a-select-option",{attrs:{value:2}},[t._v("阻断")])],1)],1):t._e(),void 0!==t.form.data.keywordsListName?a("a-form-model-item",{attrs:{label:"关键字",prop:"keywordsListName"}},[a("a-input",{staticClass:"dialog-input-height",attrs:{disabled:"create"!==t.dialogType,placeholder:"请输入关键字",maxLength:255},model:{value:t.form.data.keywordsListName,callback:function(e){t.$set(t.form.data,"keywordsListName",e)},expression:"form.data.keywordsListName"}})],1):t._e()],1):t._e(),a("template",{slot:"footer"},[a("a-button",{attrs:{type:"primary",loading:t.confirmLoading},on:{click:t.saveClick}},[t._v("保存")]),a("a-button",{on:{click:t.clickCancel}},[t._v("取消")])],1)],2),a("a-modal",{attrs:{closable:!0,width:"700px",title:t.title,"mask-closable":!1,footer:null},on:{cancel:t.clickCancelImport},model:{value:t.importVisible,callback:function(e){t.importVisible=e},expression:"importVisible"}},[a("div",{staticStyle:{height:"50px","line-height":"50px","font-size":"16px",color:"#0ab1c5"}},[a("span",[t._v(t._s(t.importFailedData.msg))])]),a("a-table",{attrs:{pagination:{pageSize:20,size:"small"},rowKey:"number",columns:t.importColumns,"data-source":t.importFailedData.rows}})],1)],1)},n=[],c=a("ade3"),r=a("5530"),s=(a("99af"),a("b0c0"),a("ac1f"),a("841c"),a("d3b7"),a("e9c4"),a("2f62")),l=a("ba79"),d=a("a00a"),p=a("ca6b"),m=a("b775"),f=a("c2f2"),u=a("d9f9"),h=[{title:"策略名称",dataIndex:"name"},{title:"关键字",dataIndex:"keywordsListName"},{title:"执行动作",ellipsis:!0,scopedSlots:{customRender:"execAction"}},{title:"操作",scopedSlots:{customRender:"operations"}}],g="strategy",y="".concat(l["b"]).concat(g,"/strategy-trcontent/import-data"),b="".concat(l["b"]).concat(g,"/strategy-trcontent/export-data"),v="single/strategy-trcontent.xlsx",k=(i={name:"trcontent",computed:Object(r["a"])({},Object(s["b"])("account",["user"])),components:{BdataShow:p["a"]},mixins:[f["a"]],filters:{convertSecurityRank:u["x"]},props:{},data:function(){return{readOnly:!1,columns:h,loading:!1,table:{data:[],total:0},importFailedData:{},importVisible:!1,search:{name:""},visible:!1,confirmLoading:!1,title:"",dialogType:"",form:{data:{id:"",name:"",matchType:"1;2;3",keywordsListName:"",securityRank:1,codeFormat:"",execAction:2},rules:{name:d["a"].name,keywordsListName:d["a"].input,execAction:d["a"].select,securityRank:d["a"].select}},importDataUrl:y,exportDataUrl:b,templateUrl:v}}},Object(c["a"])(i,"filters",{convertSecurityRank:u["x"],convertCodeFormatState:u["h"],convertStrategyList:u["A"],convertExecAction:u["n"]}),Object(c["a"])(i,"created",(function(){this.readOnly=JSON.parse(localStorage.getItem("strategy-trcontent"))||!1})),Object(c["a"])(i,"mounted",(function(){})),Object(c["a"])(i,"methods",{resetUpdate:function(){this.search.name="",this.update()},update:function(){this.page=1,this.pageSize=10,this.uploadList(this.page,this.pageSize,this.search)},handleImportChange:function(t){this.spinning=!0,t.rows.length>0?(this.title="导入",this.spinning=!1,this.importFailedData=t,this.importVisible=!0):this.spinning=!1,this.uploadList(this.page,this.pageSize,this.search)},tableParamChanged:function(t){this.page=t.page,this.pageSize=t.pageSize,this.uploadList(this.page,this.pageSize,this.search)},uploadList:function(t,e,a){var i=this;this.loading=!0,Object(m["b"])("strategy/strategy-trcontents?offset=".concat((t-1)*e,"&limit=").concat(e,"&search=").concat(a.name),m["a"].GET).then((function(t){t.rows.length>0?(i.table.data=t.rows,i.table.total=t.total):(i.table.data=[],i.table.total=0)})).catch((function(){i.table.data=[],i.table.total=0})).finally((function(){i.loading=!1}))},openDialog:function(t){this.dialogType="","create"==t?this.title="新建":"view"==t?this.title="查看详情":"modify"==t?this.title="修改":"delete"==t&&(this.title="删除"),this.dialogType=t,this.visible=!0},contentView:function(t){var e=this;Object(m["b"])("strategy/strategy-trcontent/".concat(t),m["a"].GET).then((function(t){e.form.data=t,e.openDialog("view")}))},contentModify:function(t){var e=this;e.$confirm({content:"如当前策略已与已下发的服务关联，保存后将自动下发，确定修改？",okText:"确认",cancelText:"取消",onOk:function(){Object(m["b"])("strategy/strategy-trcontent/".concat(t),m["a"].GET).then((function(t){e.form.data=t,e.openDialog("modify")}))},onCancel:function(){}})},contentDelete:function(t){this.form.data.id=t,this.openDialog("delete")},batchDelete:function(t){var e=this;e.$confirm({content:"确认批量删除吗？",okText:"确认",cancelText:"取消",onOk:function(){Object(m["b"])("strategy/strategy-trcontent/batch-delete?ids=".concat(t),m["a"].DELETE).then((function(t){var a=t.rows,i=t.msg;a.length>0?(e.title="批量删除",e.importFailedData.rows=a,e.importFailedData.msg=i,e.importVisible=!0,e.uploadList(e.page,e.pageSize,e.search)):(e.$message.success("批量删除成功！"),e.uploadList(e.page,e.pageSize,e.search))}))},onCancel:function(){}})},clickCancelImport:function(){var t=this;this.importVisible=!1,setTimeout((function(){t.importFailedData={}}),200)},saveClick:function(){var t=this;t.confirmLoading=!0;var e=m["a"].POST;if("modify"==t.dialogType&&(e=m["a"].PUT),"create"==t.dialogType||"modify"==t.dialogType){var a=JSON.parse(JSON.stringify(t.form.data));t.$refs["form"].validate((function(i){if(!i)return t.confirmLoading=!1,!1;Object(m["b"])("strategy/strategy-trcontent",e,a).then((function(){t.title="",t.visible=!1,t.confirmLoading=!1,t.uploadList(t.page,t.pageSize,t.search),t.form.data={id:"",name:"",matchType:"1;2;3",keywordsListName:"",securityRank:1,codeFormat:"",execAction:2}})).catch((function(){t.confirmLoading=!1}))}))}else"delete"==t.dialogType&&Object(m["b"])("strategy/strategy-trcontent/".concat(t.form.data.id),m["a"].DELETE).then((function(){t.title="",t.visible=!1,t.confirmLoading=!1,t.uploadList(t.page,t.pageSize,t.search),t.form.data.id=""})).catch((function(){t.title="",t.visible=!1,t.confirmLoading=!1}))},clickCancel:function(){var t=this;this.visible=!1,this.$nextTick((function(){t.confirmLoading=!1,t.title="","modify"!=t.dialogType&&"create"!=t.dialogType||t.$refs["form"].clearValidate(),t.form.data={id:"",name:"",matchType:"1;2;3",keywordsListName:"",securityRank:1,codeFormat:"",execAction:2}}))}}),Object(c["a"])(i,"watch",{$route:function(t,e){var a=this;e.path!==t.path&&this.$nextTick((function(){a.dialog&&a.dialog.close()}))}}),Object(c["a"])(i,"beforeDestroy",(function(){this.dialog&&this.dialog.close()})),i),x=k,w=(a("c02d"),a("2877")),L=Object(w["a"])(x,o,n,!1,null,"03c4ce2c",null);e["default"]=L.exports},8488:function(t,e,a){},c02d:function(t,e,a){"use strict";a("8488")}}]);