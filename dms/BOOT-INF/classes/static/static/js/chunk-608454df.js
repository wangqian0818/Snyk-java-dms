(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-608454df"],{"0618":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-table",{ref:"table",staticClass:"AStockOutDetailTable",attrs:{columns:e.columns,dataSource:e.data,rowKey:e.rowKey,bordered:e.bordered,loading:e.loading,size:e.size,"row-selection":e.rowSelection,pagination:{current:e.page,pageSize:e.pageSize,total:e.total,pageSizeOptions:e.pageSizeOptions,onChange:e.onPageChange,onShowSizeChange:e.onShowSizeChange,showSizeChanger:e.showSizeChanger,showQuickJumper:e.showQuickJumper,hideOnSinglePage:e.hideOnSinglePage,showTotal:e.showTotal,size:e.size,showLessItems:e.showLessItems},scroll:{y:e.tableHeight}},scopedSlots:e._u([{key:"number",fn:function(t,a,n){return e.showIndex?[e._v(" "+e._s(n+1)+" ")]:void 0}},e._l(Object.keys(e.$scopedSlots).filter((function(e){return"expandedRowRender"!==e})),(function(t){return{key:t,fn:function(a,n,r){return[e._t(t,null,null,{text:a,record:n,index:r})]}}})),{key:e.$scopedSlots.expandedRowRender?"expandedRowRender":"",fn:function(t,a,n,r){return[e._t(e.$scopedSlots.expandedRowRender?"expandedRowRender":"",null,null,{record:t,index:a,indent:n,expanded:r})]}}],null,!0)},[e._l(Object.keys(e.$slots),(function(t){return a("template",{slot:t},[e._t(t)],2)}))],2)],1)},r=[],i=(a("a9e3"),a("9b10")),s={name:"BFixedTable",mixins:[i["a"]],props:{columns:{type:Array,required:!0},pageSizeOptions:{type:Array,default:function(){return["10","20","50","100","200"]}},showIndex:{type:Boolean,default:!0},rowKey:String,tableHeight:{type:Number,default:550},beautyScroller:{type:Boolean,default:!0},data:{type:Array,default:function(){return[]}},total:{type:Number,default:0},bordered:{type:Boolean,default:!0},initPage:{type:Number,default:1},initPageSize:{type:Number,default:10},showOuterBorder:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},showTotal:{type:Function,default:function(e){return"总共".concat(e,"条")}},showQuickJumper:{type:Boolean,default:!0},showSizeChanger:{type:Boolean,default:!0},hideOnSinglePage:{type:Boolean,default:!1},showLessItems:{type:Boolean,default:!1},size:{type:String,default:"default"},rootData:{type:Object,default:function(){}},rowSelection:{type:Object,default:function(){return null}}},data:function(){return{page:1,pageSize:10}},mounted:function(){this.fixedHeight(),this.updateData(),this.addIndex(),this.beautyScroller&&this.beautyScroll(),this.showOuterBorder&&this.setOutBorder(),this.page=this.initPage,this.pageSize=this.initPageSize},watch:{initPage:function(e){this.page!==e&&(this.page=e,this.updateData())},initPageSize:function(e){this.pageSize!==e&&(this.pageSize=e,this.updateData())},columns:function(){this.addIndex()},total:function(){this.fixedHeight()},tableHeight:function(){this.fixedHeight()}},methods:{addIndex:function(){this.showIndex&&this.columns.length>0&&"序号"!==this.columns[0].title&&this.columns.unshift({title:"序号",scopedSlots:{customRender:"number"},width:80})},fixedHeight:function(){var e=this,t=this.$refs.table.$el;this.total>0?this.modifyStyleByClass(t,"ant-table-body",{"min-height":"".concat(this.tableHeight,"px"),"max-height":"".concat(this.tableHeight,"px")}):(this.modifyStyleByClass(t,"ant-table-body",{"min-height":"0px","max-height":"".concat(this.tableHeight,"px")}),this.$nextTick((function(){e.modifyStyleByClass(t,"ant-table-placeholder",{"min-height":"".concat(e.tableHeight,"px"),"max-height":"".concat(e.tableHeight,"px")})})))},setOutBorder:function(){var e;null===(e=this.$refs.table.$el.classList)||void 0===e||e.add("ant-card-bordered")},beautyScroll:function(){var e=this.$refs.table.$el.querySelector(".ant-table-hide-scrollbar");e&&(e.classList.add("beauty-scroll"),e.style["margin-bottom"]="",e.style["padding-bottom"]="",e.style["min-width"]="");var t=this.$refs.table.$el.querySelector(".ant-table-body");null===t||void 0===t||t.classList.add("beauty-scroll")},onPageChange:function(e,t){this.page=e,this.pageSize=t,this.updateData()},onShowSizeChange:function(e,t){this.page=1,this.pageSize=t,this.updateData()},updateData:function(){this.$emit("change",{page:this.page,pageSize:this.pageSize,rootData:this.rootData})}}},o=s,l=(a("156c"),a("2877")),c=Object(l["a"])(o,n,r,!1,null,"eb2634aa",null);t["a"]=c.exports},"0b77":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-card",{staticStyle:{"margin-top":"30px"}},[a("div",{staticClass:"search"},[a("div",{staticClass:"title"},[e._v("查询条件")]),a("div",{staticClass:"content"},[a("span",[e._v("关键字:")]),a("span",{staticClass:"inner"},[a("a-input",{staticClass:"i-width",attrs:{maxLength:64,placeholder:"请输入用户名"},on:{pressEnter:e.clickSearch},model:{value:e.search.search,callback:function(t){e.$set(e.search,"search",t)},expression:"search.search"}})],1),a("span",{staticClass:"outer"},[a("a-button",{staticClass:"button",attrs:{type:"primary"},on:{click:function(t){return e.clickSearch(1)}}},[e._v("查询")])],1),a("span",{staticClass:"outer"},[a("a-button",{staticClass:"button",on:{click:e.resetSearch}},[e._v("重置")])],1)])]),a("div",{staticClass:"body"},[a("div",{staticClass:"buttons"},[e.readOnly?e._e():a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.createUser}},[e._v("新建")])],1),a("a-row",{staticClass:"table"},[a("a-col",{staticStyle:{padding:"0 12px"},attrs:{xl:24,lg:24,md:24,sm:24,xs:24}},[a("b-fixed-table",{attrs:{columns:e.columns,rowKey:"name",data:e.users.data,total:e.users.total,loading:e.loading,"init-page":e.page},on:{change:e.tableParamChanged},scopedSlots:e._u([{key:"name",fn:function(t){var n=t.record;return[n.name?a("span",[a("a-tooltip",[a("template",{slot:"title"},[e._v(e._s(n.name))]),e._v(" "+e._s(e._f("shortText")(n.name,12))+" ")],2)],1):a("span",[e._v("-")])]}},{key:"groupName",fn:function(t){var n=t.record;return[n.groupName?a("span",[a("a-tooltip",[a("template",{slot:"title"},[e._v(e._s(n.groupName))]),e._v(" "+e._s(e._f("shortText")(n.groupName,20))+" ")],2)],1):a("span",[e._v("-")])]}},{key:"email",fn:function(t){var n=t.record;return[n.email?a("span",{attrs:{title:n.email}},[e._v(e._s(n.email))]):a("span",[e._v("-")])]}},{key:"logined",fn:function(t){var n=t.record;return[a("a-tag",{attrs:{color:n.logined?"green":"red"}},[e._v(e._s(e._f("loginedFilter")(n.logined)))])]}},{key:"loginIp",fn:function(t){var n=t.record;return[n.loginIp?a("span",{attrs:{title:n.loginIp}},[e._v(e._s(n.loginIp))]):a("span",[e._v("-")])]}},{key:"loginTimestamp",fn:function(t){var n=t.record;return[n.loginTimestamp?a("span",[e._v(e._s(e._f("time")(n.loginTimestamp,"YYYY-MM-DD HH:mm:ss")))]):a("span",[e._v("-")])]}},{key:"operations",fn:function(t){var n=t.record;return[1==n.isDefault||e.readOnly?e._e():a("span",{},[a("span",{staticClass:"oper orange",on:{click:function(t){return e.resetPassword(n)}}},[e._v("重置密码")])]),1==n.isDefault||e.readOnly?e._e():a("span",{staticClass:"oper-margin"},[a("span",{staticClass:"oper",class:n.locked?"purple":"darkgray",on:{click:function(t){return e.unlocked(n)}}},[e._v("解锁")])]),1==n.isDefault||e.readOnly?e._e():a("span",{staticClass:"oper-margin"},[a("span",{staticClass:"oper",class:n.logined?"":"darkgray",on:{click:function(t){return e.offline(n)}}},[e._v("下线")])]),1==n.isDefault||e.readOnly?e._e():a("span",{staticClass:"oper-margin"},[a("span",{staticClass:"oper",on:{click:function(t){return e.modifyUser(n)}}},[e._v("修改")])]),1==n.isDefault||e.readOnly?e._e():a("span",{staticClass:"oper-margin"},[a("span",{staticClass:"oper red",on:{click:function(t){return e.deleteUser(n.id)}}},[e._v("删除")])]),1==n.isDefault||e.readOnly?e._e():a("span",{staticClass:"oper-margin"},[a("span",{staticClass:"oper purple",on:{click:function(t){return e.download(n.name)}}},[e._v("证书下载")])])]}}])})],1)],1)],1)])],1)},r=[],i=(a("b0c0"),a("99af"),a("0618")),s=a("1da1"),o=(a("96cf"),a("b775"));function l(e,t,a){return c.apply(this,arguments)}function c(){return c=Object(s["a"])(regeneratorRuntime.mark((function e(t,a,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(o["f"])("system/users?offset=".concat((t-1)*a,"&limit=").concat(a).concat(n),o["a"].GET));case 1:case"end":return e.stop()}}),e)}))),c.apply(this,arguments)}function u(e){return d.apply(this,arguments)}function d(){return d=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(o["f"])("system/user",o["a"].POST,t));case 1:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function p(e){return m.apply(this,arguments)}function m(){return m=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t.id,e.abrupt("return",Object(o["f"])("system/user/".concat(a),o["a"].DELETE));case 2:case"end":return e.stop()}}),e)}))),m.apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return h=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(o["f"])("system/user",o["a"].PUT,t));case 1:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function g(e){return b.apply(this,arguments)}function b(){return b=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(o["f"])("system/user/reset",o["a"].PUT,t));case 1:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}function w(e){return y.apply(this,arguments)}function y(){return y=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(o["f"])("system/user/unlock",o["a"].PUT,t));case 1:case"end":return e.stop()}}),e)}))),y.apply(this,arguments)}function v(e){return x.apply(this,arguments)}function x(){return x=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(o["f"])("system/user/unlogin",o["a"].PUT,t));case 1:case"end":return e.stop()}}),e)}))),x.apply(this,arguments)}var S=a("8cff"),k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.form.init.show?a("div",[a("a-modal",{attrs:{closable:!0,title:e.form.init.title,width:420,"mask-closable":!1},model:{value:e.form.init.show,callback:function(t){e.$set(e.form.init,"show",t)},expression:"form.init.show"}},["unlogin"===e.form.name||"unlock"===e.form.name||"delete"===e.form.name?a("div",[e._v(" "+e._s(e.form.init.msg)+" ")]):a("a-form-model",{ref:"form",attrs:{model:e.form.init.data,rules:e.form.init.rules,"label-col":{span:6},"wrapper-col":{span:16}}},[void 0!==e.form.init.data.name?a("a-form-model-item",{attrs:{label:"用户名称",prop:"name"}},[a("a-input",{staticClass:"dialog-input-height",attrs:{placeholder:"请输入名称",disabled:"create"!==e.form.name,maxLength:20},model:{value:e.form.init.data.name,callback:function(t){e.$set(e.form.init.data,"name",t)},expression:"form.init.data.name"}})],1):e._e(),void 0!==e.form.init.data.orgStructureName?a("a-form-model-item",{attrs:{label:"单位描述",prop:"orgStructureName"}},[a("a-input",{staticClass:"dialog-input-height",attrs:{maxLength:20,placeholder:"请输入"},model:{value:e.form.init.data.orgStructureName,callback:function(t){e.$set(e.form.init.data,"orgStructureName",t)},expression:"form.init.data.orgStructureName"}})],1):e._e(),void 0!==e.form.init.data.responsibility?a("a-form-model-item",{attrs:{label:"职责",prop:"responsibility"}},[a("a-input",{staticClass:"dialog-input-height",attrs:{maxLength:20,placeholder:"请输入"},model:{value:e.form.init.data.responsibility,callback:function(t){e.$set(e.form.init.data,"responsibility",t)},expression:"form.init.data.responsibility"}})],1):e._e(),void 0!==e.form.init.data.email?a("a-form-model-item",{attrs:{label:"邮箱",prop:"email"}},[a("a-input",{staticClass:"dialog-input-height",attrs:{maxLength:320,placeholder:"请输入邮箱"},model:{value:e.form.init.data.email,callback:function(t){e.$set(e.form.init.data,"email",t)},expression:"form.init.data.email"}})],1):e._e(),void 0!==e.form.init.data.phone?a("a-form-model-item",{attrs:{label:"联系方式",prop:"phone"}},[a("a-input",{staticClass:"dialog-input-height",attrs:{maxLength:28,placeholder:"请输入联系方式"},model:{value:e.form.init.data.phone,callback:function(t){e.$set(e.form.init.data,"phone",t)},expression:"form.init.data.phone"}})],1):e._e(),void 0!==e.form.init.data.password?a("a-form-model-item",{attrs:{label:"密码",prop:"password"}},[a("a-input-password",{staticClass:"dialog-input-height",attrs:{maxLength:50,placeholder:"请输入密码"},model:{value:e.form.init.data.password,callback:function(t){e.$set(e.form.init.data,"password",t)},expression:"form.init.data.password"}})],1):e._e(),void 0!==e.form.init.data.passwordConfirmed?a("a-form-model-item",{attrs:{label:"确认密码",prop:"passwordConfirmed"}},[a("a-input-password",{staticClass:"dialog-input-height",attrs:{maxLength:50,placeholder:"请输入确认密码"},model:{value:e.form.init.data.passwordConfirmed,callback:function(t){e.$set(e.form.init.data,"passwordConfirmed",t)},expression:"form.init.data.passwordConfirmed"}})],1):e._e()],1),a("template",{slot:"footer"},[a("a-button",{attrs:{type:"primary",loading:e.form.init.confirmLoading},on:{click:function(t){return e.clickSave()}}},[e._v(e._s(e.okText||e.form.init.okText))]),a("a-button",{on:{click:function(t){return e.clickCancel()}}},[e._v(e._s(e.cancelText||e.form.init.cancelText))])],1)],2)],1):e._e()},_=[],C=(a("d3b7"),a("159b"),a("b64b"),a("ac1f"),a("00b4"),a("4d63"),a("c607"),a("2c3e"),a("25f0"),a("a00a")),O=a("1748"),T=a.n(O),R=a("c2f2"),z={name:"UserDialog",mixins:[R["a"]],data:function(){var e=this;function t(){var t="密码格式不对，输入必须包含";return Object.keys(e.rule).forEach((function(a){"upper"==a&&1==e.rule[a]?t+="大写字母、":"lower"==a&&1==e.rule[a]?t+="小写字母、":"number"==a&&1==e.rule[a]?t+="数字、":"special"==a&&1==e.rule[a]?t+="特殊字符、":"pwdLength"==a&&(t=t+"长度范围：["+e.rule.pwdLength+"]")})),t}var a=[{message:"请输入密码",trigger:"blur",required:!0},{message:"不能只输入空格",trigger:"blur",whitespace:!0},{message:t,trigger:"blur",validator:function(t,a,n){var r=e.regex;r.test(a)?n():n(new Error(t.message))}}],n=[a,{message:"请输入密码",trigger:"blur",required:!0},{message:"两次密码输入不一致",trigger:"blur",validator:function(t,a,n){e.form.init.data.password!==a?n(!0):n()}}];return{regex:"",rule:{},state:"",params:"",parent:"",okText:"",cancelText:"",form:{create:{title:"新建用户",request:u,show:!0,okText:"确定",cancelText:"取消",msg:"",data:{id:"",name:"",nickName:"",orgStructureName:"",responsibility:"",email:"",password:"",passwordConfirmed:"",phone:""},rules:{name:C["a"].name,email:C["a"].mail2,password:a,passwordConfirmed:n,phone:C["a"].phone2}},resetPassword:{title:"重置密码",request:g,show:!0,okText:"确定",cancelText:"取消",msg:"",data:{id:"",name:"",password:"",passwordConfirmed:""},rules:{password:a,passwordConfirmed:n}},modify:{title:"修改用户",request:f,show:!0,okText:"确定",cancelText:"取消",msg:"",data:{id:"",name:"",nickName:"",orgStructureName:"",responsibility:"",email:"",phone:""},rules:{email:C["a"].mail2,phone:C["a"].phone2,password:a,passwordConfirmed:n}},delete:{title:"删除用户",isDelete:!0,request:p,show:!0,okText:"确定",cancelText:"取消",msg:"确定删除该用户？",data:{id:""},rules:{}},unlogin:{title:"下线",request:v,show:!0,okText:"确定",cancelText:"取消",msg:"确定下线该用户？",data:{userName:""},rules:{}},unlock:{title:"解锁",request:w,show:!0,okText:"确定",cancelText:"取消",msg:"确定解锁该用户？",data:{userName:""},rules:{}}}}},created:function(){var e=this,t=JSON.parse(localStorage.getItem("regex"));e.regex=new RegExp(t),e.rule=JSON.parse(localStorage.getItem("rules")),this.showDialog(e.state,e.params)},methods:{beforeShowDialog:function(){},beforeSave:function(e){Object.prototype.hasOwnProperty.call(e,"password")&&(e.passwordConfirmed=T.a.sm3(e.passwordConfirmed),e.password=T.a.sm3(e.password))},close:function(){this.form.init.show=!1},update:function(){var e=this;e.parent.update()}}},$=z,N=(a("8ad8"),a("2877")),j=Object(N["a"])($,k,_,!1,null,"e216fbc6",null),D=j.exports,P=new S["a"](D),I=a("d7b0"),B=a("ca00"),L=[{title:"用户名称",ellipsis:!0,scopedSlots:{customRender:"name"}},{title:"角色名称",ellipsis:!0,scopedSlots:{customRender:"groupName"}},{title:"单位描述",dataIndex:"orgStructureName"},{title:"职责",dataIndex:"responsibility"},{title:"邮箱",ellipsis:!0,scopedSlots:{customRender:"email"}},{title:"在线状态",ellipsis:!0,scopedSlots:{customRender:"logined"},width:90},{title:"登录IP",ellipsis:!0,scopedSlots:{customRender:"loginIp"}},{title:"登录时间",ellipsis:!0,scopedSlots:{customRender:"loginTimestamp"},width:200},{title:"操作",scopedSlots:{customRender:"operations"},width:360}],H={name:"UserManage",mixins:[R["a"]],components:{BFixedTable:i["a"]},data:function(){return{columns:L,readOnly:!1,dialog:P,loading:!1,users:{data:[],total:0}}},filters:{time:B["n"],shortText:B["m"],loginedFilter:function(e){return e?"在线":"离线"}},mounted:function(){},created:function(){this.readOnly=JSON.parse(localStorage.getItem("user"))||!1},methods:{createUser:function(){var e=this;e.dialog.open({state:"create",parent:e})},permissionCheck:function(e,t){return Object(I["g"])(e,t)},modifyUser:function(e){var t=this;t.dialog.open({state:"modify",params:e,parent:t})},deleteUser:function(e){var t=this;t.dialog.open({state:"delete",parent:t,params:{id:e}})},resetPassword:function(e){var t=this;t.dialog.open({state:"resetPassword",parent:t,params:{id:e.id,name:e.name}})},unlocked:function(e){if(!e.locked)return!1;var t=this;t.dialog.open({state:"unlock",parent:t,params:{userName:e.name}})},offline:function(e){if(!e.logined)return!1;var t=this;t.dialog.open({state:"unlogin",parent:t,params:{userName:e.name}})},update:function(e,t){var a=this;this.page=e||this.page,this.pageSize=t||this.pageSize,this.loading=!0,l(this.page,this.pageSize,this.searchParams).then((function(e){var t=e.data;t&&(a.users.total=null==t.total?0:t.total,a.users.data=t.rows,a.loading=!1)})).catch((function(){a.loading=!1}))},download:function(e){var t="".concat(this.BASE_URL,"system/user/download?name=").concat(e);window.open(t,"_blank")}},destroyed:function(){},watch:{$route:function(e,t){var a=this;t.path!==e.path&&this.$nextTick((function(){a.dialog&&a.dialog.close()}))}},beforeDestroy:function(){this.dialog&&this.dialog.close()}},U=H,E=(a("f5cd"),Object(N["a"])(U,n,r,!1,null,"1fb5255a",null));t["default"]=E.exports},"156c":function(e,t,a){"use strict";a("1bbf")},"1bbf":function(e,t,a){},"5ccb":function(e,t,a){},"8ad8":function(e,t,a){"use strict";a("c3d8")},c3d8:function(e,t,a){},f5cd:function(e,t,a){"use strict";a("5ccb")}}]);