(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6ec65b41"],{"0618":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("a-table",{ref:"table",staticClass:"AStockOutDetailTable",attrs:{columns:e.columns,dataSource:e.data,rowKey:e.rowKey,bordered:e.bordered,loading:e.loading,size:e.size,"row-selection":e.rowSelection,pagination:{current:e.page,pageSize:e.pageSize,total:e.total,pageSizeOptions:e.pageSizeOptions,onChange:e.onPageChange,onShowSizeChange:e.onShowSizeChange,showSizeChanger:e.showSizeChanger,showQuickJumper:e.showQuickJumper,hideOnSinglePage:e.hideOnSinglePage,showTotal:e.showTotal,size:e.size,showLessItems:e.showLessItems},scroll:{y:e.tableHeight}},scopedSlots:e._u([{key:"number",fn:function(t,i,n){return e.showIndex?[e._v(" "+e._s(n+1)+" ")]:void 0}},e._l(Object.keys(e.$scopedSlots).filter((function(e){return"expandedRowRender"!==e})),(function(t){return{key:t,fn:function(i,n,a){return[e._t(t,null,null,{text:i,record:n,index:a})]}}})),{key:e.$scopedSlots.expandedRowRender?"expandedRowRender":"",fn:function(t,i,n,a){return[e._t(e.$scopedSlots.expandedRowRender?"expandedRowRender":"",null,null,{record:t,index:i,indent:n,expanded:a})]}}],null,!0)},[e._l(Object.keys(e.$slots),(function(t){return i("template",{slot:t},[e._t(t)],2)}))],2)],1)},a=[],o=(i("a9e3"),i("9b10")),s={name:"BFixedTable",mixins:[o["a"]],props:{columns:{type:Array,required:!0},pageSizeOptions:{type:Array,default:function(){return["10","20","30","40"]}},showIndex:{type:Boolean,default:!0},rowKey:String,tableHeight:{type:Number,default:550},beautyScroller:{type:Boolean,default:!0},data:{type:Array,default:function(){return[]}},total:{type:Number,default:0},bordered:{type:Boolean,default:!0},initPage:{type:Number,default:1},initPageSize:{type:Number,default:10},showOuterBorder:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},showTotal:{type:Function,default:function(e){return"总共".concat(e,"条")}},showQuickJumper:{type:Boolean,default:!0},showSizeChanger:{type:Boolean,default:!0},hideOnSinglePage:{type:Boolean,default:!1},showLessItems:{type:Boolean,default:!1},size:{type:String,default:"default"},rootData:{type:Object,default:function(){}},rowSelection:{type:Object,default:function(){return null}}},data:function(){return{page:1,pageSize:10}},mounted:function(){this.fixedHeight(),this.updateData(),this.addIndex(),this.beautyScroller&&this.beautyScroll(),this.showOuterBorder&&this.setOutBorder(),this.page=this.initPage,this.pageSize=this.initPageSize},watch:{initPage:function(e){this.page!==e&&(this.page=e,this.updateData())},initPageSize:function(e){this.pageSize!==e&&(this.pageSize=e,this.updateData())},columns:function(){this.addIndex()},total:function(){this.fixedHeight()},tableHeight:function(){this.fixedHeight()}},methods:{addIndex:function(){this.showIndex&&this.columns.length>0&&"序号"!==this.columns[0].title&&this.columns.unshift({title:"序号",scopedSlots:{customRender:"number"},width:80})},fixedHeight:function(){var e=this,t=this.$refs.table.$el;this.total>0?this.modifyStyleByClass(t,"ant-table-body",{"min-height":"".concat(this.tableHeight,"px"),"max-height":"".concat(this.tableHeight,"px")}):(this.modifyStyleByClass(t,"ant-table-body",{"min-height":"0px","max-height":"".concat(this.tableHeight,"px")}),this.$nextTick((function(){e.modifyStyleByClass(t,"ant-table-placeholder",{"min-height":"".concat(e.tableHeight,"px"),"max-height":"".concat(e.tableHeight,"px")})})))},setOutBorder:function(){var e;null===(e=this.$refs.table.$el.classList)||void 0===e||e.add("ant-card-bordered")},beautyScroll:function(){var e=this.$refs.table.$el.querySelector(".ant-table-hide-scrollbar");e&&(e.classList.add("beauty-scroll"),e.style["margin-bottom"]="",e.style["padding-bottom"]="",e.style["min-width"]="");var t=this.$refs.table.$el.querySelector(".ant-table-body");null===t||void 0===t||t.classList.add("beauty-scroll")},onPageChange:function(e,t){this.onShowSizeChange(e,t)},onShowSizeChange:function(e,t){this.page=e,this.pageSize=t,this.updateData()},updateData:function(){this.$emit("change",{page:this.page,pageSize:this.pageSize,rootData:this.rootData})}}},r=s,l=(i("8c2b"),i("2877")),d=Object(l["a"])(r,n,a,!1,null,"fe898692",null);t["a"]=d.exports},4354:function(e,t,i){},"8c2b":function(e,t,i){"use strict";i("b381")},"9e64":function(e,t,i){"use strict";i("4354")},b381:function(e,t,i){},d8f4:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("a-card",{staticStyle:{"margin-top":"30px"}},[i("div",{staticClass:"body"},[i("div",{staticClass:"buttons"},[i("a-button",{attrs:{type:"primary",icon:"sync"},on:{click:e.initMenu}},[e._v("刷新")]),i("a-button",{attrs:{type:"primary",icon:"plus",disabled:e.total>1},on:{click:e.addIdenify}},[e._v("添加认证")])],1),i("a-row",{staticClass:"table"},[i("a-col",{staticStyle:{padding:"0 12px"},attrs:{xl:24,lg:24,md:24,sm:24,xs:24}},[i("b-fixed-table",{attrs:{columns:e.columns,rowKey:"name",data:e.idenifyList,total:e.total,loading:e.loading,"init-page":e.page},on:{change:e.tableParamChanged},scopedSlots:e._u([{key:"userName",fn:function(t){var n=t.record;return[n.userName?i("span",{attrs:{title:n.userName}},[e._v(e._s(n.userName))]):i("span",[e._v("-")])]}},{key:"hostName",fn:function(t){var n=t.record;return[n.hostName?i("span",{attrs:{title:n.hostName}},[e._v(e._s(n.hostName))]):i("span",[e._v("-")])]}},{key:"certFileName",fn:function(t){var n=t.record;return[n.certFileName?i("span",{attrs:{title:n.certFileName}},[e._v(e._s(n.certFileName))]):i("span",[e._v("-")])]}},{key:"port",fn:function(t){var n=t.record;return[n.port?i("span",{attrs:{title:n.port}},[e._v(e._s(n.port))]):i("span",[e._v("-")])]}},{key:"result",fn:function(t){var n=t.record;return[n.result?i("span",{attrs:{title:n.result}},[e._v(e._s(n.result))]):i("span",[e._v("-")])]}},{key:"addTime",fn:function(t){var n=t.record;return[n.addTime?i("span",{attrs:{title:n.addTime}},[e._v(e._s(n.addTime))]):i("span",[e._v("-")])]}},{key:"operations",fn:function(t){var n=t.record;return["取消认证"==n.result?i("span",{staticClass:"oper-margin"},[i("span",{staticClass:"oper red",on:{click:function(t){return e.delCert(n.id)}}},[e._v("删除")])]):e._e(),"取消认证"==n.result?i("span",{staticClass:"oper-margin"},[i("span",{staticClass:"oper red",on:{click:function(t){return e.doCert(n.id)}}},[e._v("重新认证")])]):e._e(),"认证成功"==n.result?i("span",{staticClass:"oper-margin"},[i("span",{staticClass:"oper red",on:{click:function(t){return e.cancelCert(n.id)}}},[e._v("取消认证")])]):e._e()]}}])})],1)],1)],1)]),i("a-modal",{attrs:{title:"添加认证",closable:!0,keyboard:!1,"mask-closable":!1,destroyOnClose:""},on:{cancel:e.cancel,ok:e.submitSub},model:{value:e.idenifyVisible,callback:function(t){e.idenifyVisible=t},expression:"idenifyVisible"}},[i("a-form-model",{ref:"idenifyForm",attrs:{model:e.idenifyForm,rules:e.rules,"label-col":{span:8},"wrapper-col":{span:16}}},[i("a-form-model-item",{attrs:{label:"认证主机",prop:"hostName"}},[i("a-input",{attrs:{maxLength:20},model:{value:e.idenifyForm.hostName,callback:function(t){e.$set(e.idenifyForm,"hostName",t)},expression:"idenifyForm.hostName"}})],1),i("a-form-model-item",{attrs:{label:"认证端口",prop:"port"}},[i("a-input",{attrs:{maxLength:5},model:{value:e.idenifyForm.port,callback:function(t){e.$set(e.idenifyForm,"port",t)},expression:"idenifyForm.port"}})],1),i("a-form-model-item",{attrs:{label:"证书密码",prop:"keyPwd"}},[i("a-input",{attrs:{maxLength:20},model:{value:e.idenifyForm.keyPwd,callback:function(t){e.$set(e.idenifyForm,"keyPwd",t)},expression:"idenifyForm.keyPwd"}})],1),i("a-form-model-item",{attrs:{label:"证书文件",required:""}},[i("a-upload-dragger",{staticStyle:{width:"100%",height:"90px"},attrs:{multiple:!1,"before-upload":e.beforeUpload1,fileList:e.fileList,remove:e.handleRemove1},on:{change:e.handleChange}},[i("div",{staticStyle:{color:"#40a9ff","font-size":"24px"}},[i("a-icon",{attrs:{type:"inbox"}})],1),i("div",[e._v("点击或拖拽文件到此处")])])],1)],1)],1)],1)},a=[],o=(i("ac1f"),i("841c"),i("99af"),i("0618")),s=i("c2f2"),r=i("b775"),l=i("a00a"),d=[{title:"认证用户",scopedSlots:{customRender:"userName"}},{title:"主机域名或者IP",scopedSlots:{customRender:"hostName"}},{title:"证书名称",scopedSlots:{customRender:"certFileName"}},{title:"端口",scopedSlots:{customRender:"port"}},{title:"认证状态",scopedSlots:{customRender:"result"}},{title:"认证时间",scopedSlots:{customRender:"addTime"}},{title:"操作",dataIndex:"",key:"",scopedSlots:{customRender:"operations"}}],c={name:"idenify",mixins:[s["a"]],components:{BFixedTable:o["a"]},data:function(){return{columns:d,loading:!1,idenifyList:[],page:1,pageSize:10,search:"",total:0,idenifyVisible:!1,fileList:[],idenifyForm:{pemFile:null,keyFile:null,hostName:"",port:"",keyPwd:""},rules:{hostName:l["a"].input,port:l["a"].format23,keyPwd:l["a"].integrity}}},created:function(){this.initMenu()},mounted:function(){},methods:{initMenu:function(){this.idenifyList=[],this.page=1,this.pageSize=10,this.search="",this.updata(this.page,this.pageSize,this.search)},updata:function(e,t,i){var n=this;this.loading=!0,this.idenifyList=[],Object(r["b"])("identity/list?offset=".concat((e-1)*t,"&limit=").concat(t,"&search=").concat(i),r["a"].POST).then((function(e){n.idenifyList=e.list,n.total=e.total,n.loading=!1})).catch((function(){n.loading=!1}))},cancelCert:function(e){var t=this;Object(r["b"])("identity/cancelCert?id=".concat(e),r["a"].POST).then((function(){t.initMenu()})).catch((function(){t.loading=!1}))},doCert:function(e){var t=this;Object(r["b"])("identity/doCert?id=".concat(e),r["a"].POST).then((function(){t.initMenu()})).catch((function(){t.loading=!1}))},delCert:function(e){var t=this;Object(r["b"])("identity/delCert?id=".concat(e),r["a"].POST).then((function(){t.initMenu()})).catch((function(){t.loading=!1}))},tableParamChanged:function(e){this.page=e.page,this.pageSize=e.pageSize,this.updata(this.page,this.pageSize,this.search)},clickSearch:function(){this.page=1,this.pageSize=10,this.updata(this.page,this.pageSize,this.search)},resetSearch:function(){this.initMenu()},addIdenify:function(){this.idenifyVisible=!0},beforeUpload1:function(e,t){return this.idenifyForm.pemFile=e,!1},handleChange:function(e){var t=e.fileList;t.length>1?(this.fileList=[t[0]],this.$message.error("只能上传一个证书")):this.fileList=t},beforeUpload2:function(e,t){return this.idenifyForm.keyFile=e,!1},handleRemove1:function(){this.idenifyForm.pemFile=null},handleRemove2:function(){this.idenifyForm.keyFile=null},submitSub:function(){var e=this;if(null==this.idenifyForm.pemFile)this.$message.error("认证文件不能为空");else{var t=new FormData;t.append("pemFile",this.idenifyForm.pemFile),t.append("hostName",this.idenifyForm.hostName),t.append("port",this.idenifyForm.port),t.append("keyPwd",this.idenifyForm.keyPwd),Object(r["b"])("identity/add",r["a"].POST,t).then((function(t){e.$message.success(t),e.cancel(),e.initMenu()}))}},cancel:function(){this.idenifyVisible=!1,this.idenifyForm={},this.fileList=[],this.$refs["idenifyForm"].clearValidate()}},destroyed:function(){},watch:{},beforeDestroy:function(){}},u=c,h=(i("9e64"),i("2877")),p=Object(h["a"])(u,n,a,!1,null,"a8fa8ef0",null);t["default"]=p.exports}}]);