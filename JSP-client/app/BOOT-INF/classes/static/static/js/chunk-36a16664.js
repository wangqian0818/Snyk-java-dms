(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-36a16664"],{"0618":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-table",{ref:"table",staticClass:"AStockOutDetailTable",attrs:{columns:t.columns,dataSource:t.data,rowKey:t.rowKey,bordered:t.bordered,loading:t.loading,size:t.size,"row-selection":t.rowSelection,pagination:{current:t.page,pageSize:t.pageSize,total:t.total,pageSizeOptions:t.pageSizeOptions,onChange:t.onPageChange,onShowSizeChange:t.onShowSizeChange,showSizeChanger:t.showSizeChanger,showQuickJumper:t.showQuickJumper,hideOnSinglePage:t.hideOnSinglePage,showTotal:t.showTotal,size:t.size,showLessItems:t.showLessItems},scroll:{y:t.tableHeight}},scopedSlots:t._u([{key:"number",fn:function(e,a,i){return t.showIndex?[t._v(" "+t._s(i+1)+" ")]:void 0}},t._l(Object.keys(t.$scopedSlots).filter((function(t){return"expandedRowRender"!==t})),(function(e){return{key:e,fn:function(a,i,n){return[t._t(e,null,null,{text:a,record:i,index:n})]}}})),{key:t.$scopedSlots.expandedRowRender?"expandedRowRender":"",fn:function(e,a,i,n){return[t._t(t.$scopedSlots.expandedRowRender?"expandedRowRender":"",null,null,{record:e,index:a,indent:i,expanded:n})]}}],null,!0)},[t._l(Object.keys(t.$slots),(function(e){return a("template",{slot:e},[t._t(e)],2)}))],2)],1)},n=[],s=(a("a9e3"),a("9b10")),o={name:"BFixedTable",mixins:[s["a"]],props:{columns:{type:Array,required:!0},pageSizeOptions:{type:Array,default:function(){return["10","20","30","40"]}},showIndex:{type:Boolean,default:!0},rowKey:String,tableHeight:{type:Number,default:550},beautyScroller:{type:Boolean,default:!0},data:{type:Array,default:function(){return[]}},total:{type:Number,default:0},bordered:{type:Boolean,default:!0},initPage:{type:Number,default:1},initPageSize:{type:Number,default:10},showOuterBorder:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},showTotal:{type:Function,default:function(t){return"总共".concat(t,"条")}},showQuickJumper:{type:Boolean,default:!0},showSizeChanger:{type:Boolean,default:!0},hideOnSinglePage:{type:Boolean,default:!1},showLessItems:{type:Boolean,default:!1},size:{type:String,default:"default"},rootData:{type:Object,default:function(){}},rowSelection:{type:Object,default:function(){return null}}},data:function(){return{page:1,pageSize:10}},mounted:function(){this.fixedHeight(),this.updateData(),this.addIndex(),this.beautyScroller&&this.beautyScroll(),this.showOuterBorder&&this.setOutBorder(),this.page=this.initPage,this.pageSize=this.initPageSize},watch:{initPage:function(t){this.page!==t&&(this.page=t,this.updateData())},initPageSize:function(t){this.pageSize!==t&&(this.pageSize=t,this.updateData())},columns:function(){this.addIndex()},total:function(){this.fixedHeight()},tableHeight:function(){this.fixedHeight()}},methods:{addIndex:function(){this.showIndex&&this.columns.length>0&&"序号"!==this.columns[0].title&&this.columns.unshift({title:"序号",scopedSlots:{customRender:"number"},width:80})},fixedHeight:function(){var t=this,e=this.$refs.table.$el;this.total>0?this.modifyStyleByClass(e,"ant-table-body",{"min-height":"".concat(this.tableHeight,"px"),"max-height":"".concat(this.tableHeight,"px")}):(this.modifyStyleByClass(e,"ant-table-body",{"min-height":"0px","max-height":"".concat(this.tableHeight,"px")}),this.$nextTick((function(){t.modifyStyleByClass(e,"ant-table-placeholder",{"min-height":"".concat(t.tableHeight,"px"),"max-height":"".concat(t.tableHeight,"px")})})))},setOutBorder:function(){var t;null===(t=this.$refs.table.$el.classList)||void 0===t||t.add("ant-card-bordered")},beautyScroll:function(){var t=this.$refs.table.$el.querySelector(".ant-table-hide-scrollbar");t&&(t.classList.add("beauty-scroll"),t.style["margin-bottom"]="",t.style["padding-bottom"]="",t.style["min-width"]="");var e=this.$refs.table.$el.querySelector(".ant-table-body");null===e||void 0===e||e.classList.add("beauty-scroll")},onPageChange:function(t,e){this.onShowSizeChange(t,e)},onShowSizeChange:function(t,e){this.page=t,this.pageSize=e,this.updateData()},updateData:function(){this.$emit("change",{page:this.page,pageSize:this.pageSize,rootData:this.rootData})}}},l=o,r=(a("8c2b"),a("2877")),c=Object(r["a"])(l,i,n,!1,null,"fe898692",null);e["a"]=c.exports},"2cee":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.currentDetail?a("TransFileDetails",t._b({on:{back:t.handleBack}},"TransFileDetails",t.currentDetail,!1)):a("a-card",{staticStyle:{"margin-top":"30px"}},[a("div",{staticClass:"search"},[a("div",{staticClass:"title"},[t._v("查询条件")]),a("div",{staticClass:"content"},[a("span",{staticClass:"inner"},[a("a-input",{staticClass:"i-width",attrs:{placeholder:"请输入服务名称",maxLength:20},model:{value:t.search.name,callback:function(e){t.$set(t.search,"name",e)},expression:"search.name"}})],1),a("span",{staticClass:"inner"},[a("a-select",{staticClass:"i-width",attrs:{placeholder:"请选择位置",getPopupContainer:function(t){return t.parentNode}},on:{change:t.update},model:{value:t.search.location,callback:function(e){t.$set(t.search,"location",e)},expression:"search.location"}},[a("a-select-option",{attrs:{value:"sender"}},[t._v("发送端")]),a("a-select-option",{attrs:{value:"receiver"}},[t._v("接收端")])],1)],1),a("span",{staticClass:"outer"},[a("a-button",{staticClass:"button",attrs:{type:"primary"},on:{click:t.clickSearch}},[t._v("查询")]),a("a-button",{staticClass:"button oper-margin",attrs:{type:"primary"},on:{click:t.reset}},[t._v("重置")])],1)])]),a("div",{staticClass:"body"},[a("a-spin",{attrs:{spinning:t.spinning,tip:"请稍等！"}},[a("a-row",{staticClass:"table"},[a("b-fixed-table",{staticStyle:{"word-break":"break-all"},attrs:{columns:t.columns,rowKey:"id",data:t.table.data,total:t.table.total,loading:t.loading,"init-page":t.page},on:{change:t.tableParamChanged},scopedSlots:t._u([{key:"operations",fn:function(e){var i=e.record;return[a("span",{staticClass:"oper-margin"},[a("span",{staticClass:"oper red",on:{click:function(e){return t.showDetailPage(i)}}},[t._v("详情")])])]}}],null,!1,1629362896)})],1)],1)],1)])],1)},n=[],s=(a("ac1f"),a("841c"),a("d3b7"),a("99af"),a("b0c0"),a("b775")),o=a("0618"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-card",{staticStyle:{"margin-top":"30px"}},[a("a-button",{staticStyle:{"margin-bottom":"16px"},attrs:{type:"primary"},on:{click:t.handleBack}},[t._v("返回")]),a("span",{staticClass:"title",staticStyle:{"margin-left":"50px"}},[t._v("服务名称：")]),a("span",{staticClass:"content",staticStyle:{"font-size":"18px","font-weight":"bold",color:"#0ab1c5"}},[t._v(t._s(t.name))]),a("div",{staticClass:"search"},[a("div",{staticClass:"title"},[t._v("查询条件")]),a("div",{staticClass:"content"},[a("span",[t._v("文件名(目录):")]),a("span",{staticClass:"inner"},[a("a-input",{staticClass:"i-width",attrs:{maxLength:64,placeholder:"请输入文件名(目录)"},on:{pressEnter:t.refresh},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("span",{staticClass:"outer"},[a("a-button",{staticClass:"button",attrs:{type:"primary"},on:{click:t.refresh}},[t._v("查询")])],1)])]),a("div",{staticClass:"body"},[a("a-spin",{attrs:{spinning:t.spinning,tip:"正在刷新，请稍等！"}},[a("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[a("div",[a("span",{staticStyle:{"margin-right":"10px"}},[a("span",{staticClass:"title"},[t._v("当前路径:")])]),a("span",{staticClass:"content"},[a("a",{staticStyle:{"text-decoration":"underline"},on:{click:t.choseRootPath}},[t._v("根路径")]),a("span",{staticStyle:{margin:"0 5px"}},[t._v("/")]),t._l(t.pathArr,(function(e){return a("span",{key:e.path+"-"+e.updateTime},[a("a",{staticStyle:{"text-decoration":"underline"},on:{click:function(a){return t.choseSubPath(e)}}},[t._v(t._s(e.name))]),a("span",{staticStyle:{margin:"0 5px"}},[t._v("/")])])}))],2)]),a("div",{staticClass:"buttons"},[t.labelEnable&&"sender"==t.type?a("a-button",{staticStyle:{"margin-right":"8px"},attrs:{type:"primary"},on:{click:t.rootPathSign}},[t._v("根路径标识")]):t._e(),a("a-button",{attrs:{type:"primary",icon:"plus",disabled:t.pathArr.length>=5||!t.editable},on:{click:t.createDir}},[t._v("创建子目录")]),a("span",{staticClass:"oper-margin"},[a("a-upload",{attrs:{name:"file",action:t.uploadUrl+"?id="+t.id+"&path="+t.path+"&type="+t.type,"before-upload":t.beforeUpload,disabled:!t.editable,multiple:!1,"show-upload-list":!1},on:{change:t.handleImportChange}},[a("a-button",{attrs:{type:"primary",icon:"import"}},[t._v("上传文件(最大2GB)")])],1)],1)],1)]),a("a-row",{staticClass:"table"},[a("a-table",{attrs:{columns:t.columns,dataSource:t.data,rowKey:"path",bordered:"",pagination:{pageSize:20,size:"small",showTotal:function(t){return"总共"+t+"条"}}},scopedSlots:t._u([{key:"number",fn:function(e,a,i){return[t._v(t._s(i+1))]}},{key:"name",fn:function(e){return["目录"==e.type?a("span",[a("a",{staticStyle:{"text-decoration":"underline"},on:{click:function(a){return t.clickPath(e)}}},[t._v(t._s(e.name))])]):a("span",{attrs:{title:e.name}},[t._v(t._s(e.name))])]}},{key:"operations",fn:function(e){return[a("span",{staticClass:"oper-margin"},[a("span",{staticClass:"oper red",on:{click:function(a){return t.deleteFile(e.path)}}},[t._v("删除")])]),"目录"==e.type&&"sender"==t.type&&e.workpathInited?[a("span",{staticClass:"oper-margin"},[a("span",{staticClass:"oper",on:{click:function(a){return t.pathSign(e)}}},[t._v("标识")])]),a("span",{staticClass:"oper-margin"},[a("span",{staticClass:"oper",on:{click:function(a){return t.inheritanceSign(e.path)}}},[t._v("继承上级标识")])])]:t._e(),"目录"!=e.type?[a("span",{staticClass:"oper-margin"},[a("span",{staticClass:"oper",on:{click:function(a){return t.downloadFile(e.path)}}},[t._v("下载")])])]:t._e()]}}])})],1)],1)],1)],1),a("a-modal",{attrs:{title:"创建子目录",closable:!0,keyboard:!1,"mask-closable":!1},on:{cancel:t.cancelSub,ok:t.submitSub},model:{value:t.subDirVisible,callback:function(e){t.subDirVisible=e},expression:"subDirVisible"}},[a("a-form-model",{ref:"subForm",attrs:{model:t.subForm.data,rules:t.subForm.rules,"label-col":{span:8},"wrapper-col":{span:16}}},[a("a-form-model-item",{attrs:{label:"父目录",prop:"parentPath"}},[a("a-input",{attrs:{disabled:"",maxLength:20},model:{value:t.subForm.data.parentPath,callback:function(e){t.$set(t.subForm.data,"parentPath",e)},expression:"subForm.data.parentPath"}})],1),a("a-form-model-item",{attrs:{label:"子目录",prop:"path"}},[a("a-input",{attrs:{maxLength:50},model:{value:t.subForm.data.path,callback:function(e){t.$set(t.subForm.data,"path",e)},expression:"subForm.data.path"}})],1)],1)],1),a("a-modal",{attrs:{title:"标识配置",closable:"init"!=t.signForm.data.type,keyboard:!1,"mask-closable":!1,showCancel:t.rootLabelConfig,confirmLoading:t.signLoading},on:{cancel:t.cancelSign,ok:t.submitSign},scopedSlots:t._u([{key:"footer",fn:function(){return["init"!=t.signForm.data.type?a("div",[a("a-button",{on:{click:t.cancelSign}},[t._v("取消")]),a("a-button",{attrs:{type:"primary",loading:t.signLoading},on:{click:t.submitSign}},[t._v("确定")])],1):a("div",[a("a-button",{attrs:{type:"primary",loading:t.signLoading},on:{click:t.submitSign}},[t._v("确定")])],1)]},proxy:!0}]),model:{value:t.signModalVisible,callback:function(e){t.signModalVisible=e},expression:"signModalVisible"}},[a("a-form-model",{ref:"signForm",attrs:{model:t.signForm.data,rules:t.signForm.rules,"label-col":{span:8},"wrapper-col":{span:16}}},[a("a-form-model-item",{attrs:{label:"类型",prop:"signType"}},[a("a-select",{attrs:{getPopupContainer:function(t){return t.parentNode}},model:{value:t.signForm.data.signType,callback:function(e){t.$set(t.signForm.data,"signType",e)},expression:"signForm.data.signType"}},t._l(t.typeList,(function(e){return a("a-select-option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1),a("a-form-model-item",{attrs:{label:"密级",prop:"signLevel"}},[a("a-select",{attrs:{getPopupContainer:function(t){return t.parentNode}},model:{value:t.signForm.data.signLevel,callback:function(e){t.$set(t.signForm.data,"signLevel",e)},expression:"signForm.data.signLevel"}},t._l(t.levelList,(function(e){return a("a-select-option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1),a("a-form-model-item",{attrs:{label:"转发区域",prop:"signScope"}},[a("a-select",{model:{value:t.signForm.data.signScope,callback:function(e){t.$set(t.signForm.data,"signScope",e)},expression:"signForm.data.signScope"}},t._l(t.scopeList,(function(e){return a("a-select-option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1)],1)],1)],1)},r=[],c=(a("a9e3"),a("5319"),a("fb6a"),a("ba79")),d=a("a00a"),p={props:{id:[String,Number],name:String,type:String,labelEnable:Boolean,rootLabelConfig:Boolean},data:function(){return{spinning:!1,editable:!0,columns:"",data:[],path:"",search:"",pathArr:[],uploadUrl:"".concat(c["b"],"trans-file/upload"),subDirVisible:!1,subForm:{data:{id:this.id,type:"",path:"",parentPath:""},rules:{path:d["a"].onePath}},signModalVisible:!1,signForm:{data:{id:this.id,type:"",filePath:"",signType:"",signLevel:"",signScope:""},rules:{signType:[{required:!0,message:"请选择类型"}],signLevel:[{required:!0,message:"请选择密级"}],signScope:[{required:!0,message:"请选择转发范围"}]}},typeList:[],scopeList:[],levelList:[],signLoading:!1}},created:function(){var t=this;this.refresh(),Object(s["b"])("label/select-options?type=type",s["a"].GET).then((function(e){t.typeList=e})),Object(s["b"])("label/select-options?type=scope",s["a"].GET).then((function(e){t.scopeList=e})),Object(s["b"])("label/select-options?type=level",s["a"].GET).then((function(e){t.levelList=e})),"sender"==this.type&&this.labelEnable?(this.columns=[{title:"文件名(目录)",scopedSlots:{customRender:"name"}},{title:"创建时间",dataIndex:"updateTime",key:"updateTime"},{title:"标识类型",dataIndex:"signType",key:"signType"},{title:"标识密级",dataIndex:"signLevel",key:"signLevel"},{title:"标识转发区域",dataIndex:"signScope",key:"signScope"},{title:"大小(B)",dataIndex:"size",key:"size"},{title:"操作",scopedSlots:{customRender:"operations"}}],this.rootLabelConfig||this.$confirm({title:"提示",content:"未配置根路径标识，必须先配置根路径标识",okText:"确定",cancelButtonProps:{style:{display:"none"}},keyboard:!1,onOk:function(){t.rootPathSign(),t.signForm.data.type="init"}})):this.columns=[{title:"文件名(目录)",scopedSlots:{customRender:"name"}},{title:"创建时间",dataIndex:"updateTime",key:"updateTime"},{title:"大小(B)",dataIndex:"size",key:"size"},{title:"操作",scopedSlots:{customRender:"operations"}}]},watch:{id:function(){this.refresh()},type:function(){this.refresh()}},methods:{refresh:function(){var t=this;this.editable=!0,this.data=[],this.spinning=!0,Object(s["b"])("/trans-file/detail/".concat(this.id,"?type=").concat(this.type,"&path=").concat(this.path,"&search=").concat(this.search),s["a"].GET).then((function(e){t.data=e})).catch((function(){t.editable=!1})).finally((function(){t.spinning=!1}))},clickPath:function(t){this.path=t.path.replace(/\\/g,"/"),this.search="",this.pathArr.push(t),this.refresh()},choseRootPath:function(){this.path="",this.search="",this.pathArr=[],this.refresh()},choseSubPath:function(t){this.path=t.path.replace(/\\/g,"/"),this.search="",this.pathArr=this.pathArr.slice(0,this.pathArr.indexOf(t)+1),this.refresh()},beforeUpload:function(t){var e=255,a=new TextEncoder,i=a.encode(t.name);return!(i.length>e)||(this.$message.error("文件名称长度不能超过 255 个字符"),this.spinning=!1,!1)},handleImportChange:function(t){this.spinning=!0,"done"===t.file.status?"SUCCESS"===t.file.response.state?(this.spinning=!1,this.$message.success(t.file.response.data),this.refresh()):"FAIL"===t.file.response.state?(this.$message.error(t.file.response.msg),this.spinning=!1,this.refresh()):this.spinning=!1:void 0===t.file.status&&(this.spinning=!1)},createDir:function(){this.subDirVisible=!0,this.subForm.data.parentPath=this.path,this.subForm.data.type=this.type,this.subForm.data.id=this.id},rootPathSign:function(){var t=this;Object(s["b"])("trans-file/label/get",s["a"].GET,{id:t.id}).then((function(e){t.signForm.data.signType=e.signType,t.signForm.data.signLevel=e.signLevel,t.signForm.data.signScope=e.signScope})),t.signModalVisible=!0},cancelSub:function(){this.subDirVisible=!1,this.subForm.data={id:this.id,type:this.type,path:"",parentPath:""}},submitSub:function(){var t=this;this.$refs["subForm"].validate((function(e){e&&Object(s["b"])("/trans-file/createSubPath",s["a"].POST,t.subForm.data).then((function(){t.$message.success("创建子目录成功"),t.cancelSub(),t.refresh()}))}))},cancelSign:function(){var t=this;this.signModalVisible=!1,setTimeout((function(){t.$refs.signForm&&t.$refs.signForm.resetFields(),t.signForm.data={id:t.id,type:"",filePath:"",signType:"",signLevel:"",signScope:""}}),300)},pathSign:function(t){this.signForm.data={id:this.id,filePath:t.path,signType:t.signType||"",signLevel:t.signLevel||"",signScope:t.signScope||""},this.signModalVisible=!0},inheritanceSign:function(t){var e=this,a=t.replace(/\\/g,"/");this.$confirm({content:"确认继承上级标识，清除当前标识吗？",okText:"确认",cancelText:"取消",onOk:function(){Object(s["b"])("trans-file/label/delete",s["a"].POST,{id:e.id,filePath:a}).then((function(){e.$message.success("继承上级标识成功"),e.refresh()}))}})},submitSign:function(){var t=this;this.signLoading=!0,this.$refs["signForm"].validate((function(e){e?Object(s["b"])("trans-file/label/add",s["a"].POST,t.signForm.data).then((function(e){e&&(t.$message.success("标识配置成功"),t.cancelSign(),t.refresh())})).finally((function(){t.signLoading=!1})):t.signLoading=!1}))},deleteFile:function(t){var e=this;this.$confirm({content:"确认删除吗？",okText:"确认",cancelText:"取消",onOk:function(){Object(s["b"])("/trans-file/delete",s["a"].POST,{id:e.id,type:e.type,path:t}).then((function(t){e.$message.success(t),e.refresh()}))}})},downloadFile:function(t){var e=t.replace(/\\/g,"/"),a="".concat(c["b"],"trans-file/download?id=").concat(this.id,"&path=").concat(e,"&type=").concat(this.type);window.open(a,"_blank")},handleBack:function(){this.$emit("back"),this.data=[],this.path="",this.search="",this.pathArr=[],this.subForm.data={id:this.id,type:this.type,path:"",parentPath:""},this.signForm.data={id:this.id,filePath:"",signType:"",signLevel:"",signScope:""},this.subDirVisible=!1,this.signModalVisible=!1,this.editable=!0,this.spinning=!1}}},u=p,h=(a("e6b5"),a("2877")),g=Object(h["a"])(u,l,r,!1,null,"487cca88",null),b=g.exports,f=a("c2f2"),m={components:{BFixedTable:o["a"],TransFileDetails:b},mixins:[f["a"]],data:function(){return{spinning:!1,columns:[{title:"服务名称",dataIndex:"name",key:"name"},{title:"服务ID",dataIndex:"transBusiFileId",key:"transBusiFileId"},{title:"服务用户",dataIndex:"userName",key:"userName"},{title:"位置",dataIndex:"typeName",key:"typeName"},{title:"数据标识",dataIndex:"labelEnableName",key:"labelEnableName"},{title:"降密脱敏",dataIndex:"confidentialityEnableName",key:"confidentialityEnableName"},{title:"数据完整性和数字签名保护",dataIndex:"completeEnableName",key:"completeEnableName"},{title:"密级限制",dataIndex:"confidentialityLevelName",key:"confidentialityLevelName"},{title:"操作",scopedSlots:{customRender:"operations"}}],search:{name:"",location:"sender"},nameList:[],currentDetail:null,table:{data:[],total:0},loading:!1}},created:function(){},watch:{$route:function(){this.currentDetail=null,this.search={name:void 0,location:"sender"},this.page=1,this.pageSize=10,this.total=0,this.data=[],this.spinning=!1,this.update()}},methods:{reset:function(){this.search={name:"",location:"sender"},this.update()},update:function(){var t=this;this.spinning=!0,this.page=1,this.pageSize=10,Object(s["b"])("trans-file/list?offset=".concat((this.page-1)*this.pageSize,"&limit=").concat(this.pageSize,"&search=").concat(this.search.name||"","&type=").concat(this.search.location||""),s["a"].GET).then((function(e){t.table.data=e.rows||[],t.table.total=e.total||0})).finally((function(){t.spinning=!1}))},showDetailPage:function(t){this.currentDetail={id:t.transBusiFileId,name:t.name,type:t.type,labelEnable:t.labelEnable,rootLabelConfig:t.rootLabelConfig}},handleBack:function(){this.currentDetail=null}}},y=m,S=(a("a397"),Object(h["a"])(y,i,n,!1,null,"2612c492",null));e["default"]=S.exports},"8c2b":function(t,e,a){"use strict";a("b381")},9383:function(t,e,a){},a397:function(t,e,a){"use strict";a("9383")},b381:function(t,e,a){},bdd0:function(t,e,a){},e6b5:function(t,e,a){"use strict";a("bdd0")}}]);