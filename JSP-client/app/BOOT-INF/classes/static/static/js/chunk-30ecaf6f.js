(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-30ecaf6f"],{"0618":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("a-table",{ref:"table",staticClass:"AStockOutDetailTable",attrs:{columns:t.columns,dataSource:t.data,rowKey:t.rowKey,bordered:t.bordered,loading:t.loading,size:t.size,"row-selection":t.rowSelection,pagination:{current:t.page,pageSize:t.pageSize,total:t.total,pageSizeOptions:t.pageSizeOptions,onChange:t.onPageChange,onShowSizeChange:t.onShowSizeChange,showSizeChanger:t.showSizeChanger,showQuickJumper:t.showQuickJumper,hideOnSinglePage:t.hideOnSinglePage,showTotal:t.showTotal,size:t.size,showLessItems:t.showLessItems},scroll:{y:t.tableHeight}},scopedSlots:t._u([{key:"number",fn:function(e,n,a){return t.showIndex?[t._v(" "+t._s(a+1)+" ")]:void 0}},t._l(Object.keys(t.$scopedSlots).filter((function(t){return"expandedRowRender"!==t})),(function(e){return{key:e,fn:function(n,a,i){return[t._t(e,null,null,{text:n,record:a,index:i})]}}})),{key:t.$scopedSlots.expandedRowRender?"expandedRowRender":"",fn:function(e,n,a,i){return[t._t(t.$scopedSlots.expandedRowRender?"expandedRowRender":"",null,null,{record:e,index:n,indent:a,expanded:i})]}}],null,!0)},[t._l(Object.keys(t.$slots),(function(e){return n("template",{slot:e},[t._t(e)],2)}))],2)],1)},i=[],s=(n("a9e3"),n("9b10")),r={name:"BFixedTable",mixins:[s["a"]],props:{columns:{type:Array,required:!0},pageSizeOptions:{type:Array,default:function(){return["10","20","30","40"]}},showIndex:{type:Boolean,default:!0},rowKey:String,tableHeight:{type:Number,default:550},beautyScroller:{type:Boolean,default:!0},data:{type:Array,default:function(){return[]}},total:{type:Number,default:0},bordered:{type:Boolean,default:!0},initPage:{type:Number,default:1},initPageSize:{type:Number,default:10},showOuterBorder:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},showTotal:{type:Function,default:function(t){return"总共".concat(t,"条")}},showQuickJumper:{type:Boolean,default:!0},showSizeChanger:{type:Boolean,default:!0},hideOnSinglePage:{type:Boolean,default:!1},showLessItems:{type:Boolean,default:!1},size:{type:String,default:"default"},rootData:{type:Object,default:function(){}},rowSelection:{type:Object,default:function(){return null}}},data:function(){return{page:1,pageSize:10}},mounted:function(){this.fixedHeight(),this.updateData(),this.addIndex(),this.beautyScroller&&this.beautyScroll(),this.showOuterBorder&&this.setOutBorder(),this.page=this.initPage,this.pageSize=this.initPageSize},watch:{initPage:function(t){this.page!==t&&(this.page=t,this.updateData())},initPageSize:function(t){this.pageSize!==t&&(this.pageSize=t,this.updateData())},columns:function(){this.addIndex()},total:function(){this.fixedHeight()},tableHeight:function(){this.fixedHeight()}},methods:{addIndex:function(){this.showIndex&&this.columns.length>0&&"序号"!==this.columns[0].title&&this.columns.unshift({title:"序号",scopedSlots:{customRender:"number"},width:80})},fixedHeight:function(){var t=this,e=this.$refs.table.$el;this.total>0?this.modifyStyleByClass(e,"ant-table-body",{"min-height":"".concat(this.tableHeight,"px"),"max-height":"".concat(this.tableHeight,"px")}):(this.modifyStyleByClass(e,"ant-table-body",{"min-height":"0px","max-height":"".concat(this.tableHeight,"px")}),this.$nextTick((function(){t.modifyStyleByClass(e,"ant-table-placeholder",{"min-height":"".concat(t.tableHeight,"px"),"max-height":"".concat(t.tableHeight,"px")})})))},setOutBorder:function(){var t;null===(t=this.$refs.table.$el.classList)||void 0===t||t.add("ant-card-bordered")},beautyScroll:function(){var t=this.$refs.table.$el.querySelector(".ant-table-hide-scrollbar");t&&(t.classList.add("beauty-scroll"),t.style["margin-bottom"]="",t.style["padding-bottom"]="",t.style["min-width"]="");var e=this.$refs.table.$el.querySelector(".ant-table-body");null===e||void 0===e||e.classList.add("beauty-scroll")},onPageChange:function(t,e){this.onShowSizeChange(t,e)},onShowSizeChange:function(t,e){this.page=t,this.pageSize=e,this.updateData()},updateData:function(){this.$emit("change",{page:this.page,pageSize:this.pageSize,rootData:this.rootData})}}},o=r,l=(n("8c2b"),n("2877")),c=Object(l["a"])(o,a,i,!1,null,"fe898692",null);e["a"]=c.exports},"18aa":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("a-card",{staticStyle:{"margin-top":"30px"}},[n("div",{staticClass:"search"},[n("div",{staticClass:"title"},[t._v("查询条件")]),n("div",{staticClass:"content"},[n("span",[t._v("文件名:")]),n("span",{staticClass:"inner"},[n("a-input",{staticClass:"i-width",attrs:{maxLength:64,placeholder:"请输入文件名"},on:{pressEnter:t.clickSearch},model:{value:t.search.search,callback:function(e){t.$set(t.search,"search",e)},expression:"search.search"}})],1),n("span",{staticClass:"outer"},[n("a-button",{staticClass:"button",attrs:{type:"primary",disabled:"sender"==t.deviceType&&t.transmitState},on:{click:t.clickSearch}},[t._v("查询")])],1)])]),n("div",{staticClass:"body"},[n("a-spin",{attrs:{spinning:t.spinning,tip:t.tip}},[n("div",{staticStyle:{display:"flex","justify-content":"end"}},[n("div",{staticClass:"buttons"},[n("span",{staticClass:"oper-margin"},[n("a-upload",{attrs:{name:"file",action:""+t.uploadUrl,multiple:!1,"show-upload-list":!1},on:{change:t.handleImportChange}},[n("a-button",{attrs:{type:"primary",icon:"import",disabled:"sender"==t.deviceType&&t.transmitState}},[t._v("上传文件")])],1),n("a-upload",{ref:"upload",attrs:{name:"file",accept:".zip,.rar","before-upload":t.beforeUpload,action:""+t.uploadUrls,multiple:!1,"show-upload-list":!1},on:{change:t.handleImportChange1}},[n("a-button",{attrs:{type:"primary",icon:"import",disabled:"sender"==t.deviceType&&t.transmitState}},[t._v("批量上传")])],1),"sender"==t.deviceType?[n("a-button",{attrs:{type:"primary",icon:"import",disabled:t.transmitState||0==t.table.data.length},on:{click:t.startTransmit}},[t._v("开始同步")]),n("a-button",{attrs:{type:"primary",icon:"import",disabled:!t.transmitState},on:{click:t.endTransmit}},[t._v("结束同步")])]:t._e(),n("a-button",{attrs:{type:"primary",icon:"import",disabled:"sender"==t.deviceType&&t.transmitState},on:{click:t.clearXFTPFile}},[t._v("清空")])],2)])]),n("a-row",{staticClass:"table"},[n("a-spin",{attrs:{spinning:t.spinning1,tip:t.tip1}},[n("a-col",{staticStyle:{padding:"0 12px"},attrs:{xl:24,lg:24,md:24,sm:24,xs:24}},[n("b-fixed-table",{attrs:{columns:t.columns,rowKey:"name",data:t.table.data,total:t.table.total,loading:t.loading,"init-page":t.page},on:{change:t.tableParamChanged},scopedSlots:t._u([{key:"name",fn:function(e){var a=e.record;return[a.name?n("span",{attrs:{title:a.name}},[t._v(t._s(a.name))]):n("span",[t._v("-")])]}},{key:"operations",fn:function(e){var a=e.record;return[n("span",{staticClass:"oper-margin"},[n("span",{staticClass:"oper red",on:{click:function(e){return t.deleteFile(a.name)}}},[t._v("删除")])]),"目录"!=a.type?[n("span",{staticClass:"oper-margin"},[n("span",{staticClass:"oper",on:{click:function(e){return t.downloadFile(a.name)}}},[t._v("下载")])])]:t._e()]}}])})],1)],1)],1)],1)],1)])],1)},i=[],s=(n("fb6a"),n("b0c0"),n("caad"),n("99af"),n("0618")),r=n("b775"),o=n("ba79"),l=n("a00a"),c=n("c2f2"),u=n("1da1");n("96cf");function p(t,e,n){return d.apply(this,arguments)}function d(){return d=Object(u["a"])(regeneratorRuntime.mark((function t(e,n,a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(r["g"])("xftp/workPathInfo?offset=".concat((e-1)*n,"&limit=").concat(n).concat(a),r["a"].GET));case 1:case"end":return t.stop()}}),t)}))),d.apply(this,arguments)}function h(){return f.apply(this,arguments)}function f(){return f=Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(r["g"])("xftp/clear",r["a"].POST));case 1:case"end":return t.stop()}}),t)}))),f.apply(this,arguments)}function g(){return m.apply(this,arguments)}function m(){return m=Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(r["g"])("xftp/start",r["a"].POST));case 1:case"end":return t.stop()}}),t)}))),m.apply(this,arguments)}function b(){return S.apply(this,arguments)}function S(){return S=Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(r["g"])("xftp/stop",r["a"].POST));case 1:case"end":return t.stop()}}),t)}))),S.apply(this,arguments)}function y(){return w.apply(this,arguments)}function w(){return w=Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(r["g"])("xftp/state",r["a"].POST));case 1:case"end":return t.stop()}}),t)}))),w.apply(this,arguments)}var v=[{title:"文件名",width:"30%",scopedSlots:{customRender:"name"}},{title:"创建时间",dataIndex:"updateTime",key:"updateTime",width:"30%"},{title:"大小(B)",dataIndex:"size",key:"size"},{title:"操作",scopedSlots:{customRender:"operations"}}],x={mixins:[c["a"]],components:{BFixedTable:s["a"]},data:function(){return{deviceType:"sender",transmitState:void 0,spinning:!1,spinning1:!1,subDirVisible:!1,loading:!1,tip:"正在上传文件，请稍等！",tip1:"正在同步文件，请稍等！",progress:0,table:{data:[],total:0},columns:v,path:"",search:{search:""},pathArr:[],uploadUrl:"".concat(o["b"],"xftp/upload"),uploadUrls:"".concat(o["b"],"xftp/batchUpload"),subForm:{data:{newPathName:"",parentPath:""},rules:{newPathName:l["a"].onePath}},refreshDsq:null}},created:function(){this.transmitState=JSON.parse(localStorage.getItem("transmitState"))||!1,this.refreshDsq=localStorage.getItem("refreshDsq")||null,null!=this.refreshDsq&&this.getGransFileXFTPState(),this.deviceType=JSON.parse(localStorage.getItem("config")).deviceType||"sender"},mounted:function(){},watch:{refreshDsq:function(t){localStorage.setItem("refreshDsq",t)},transmitState:function(t){localStorage.setItem("transmitState",t)}},methods:{update:function(t,e){var n=this;this.page=t||this.page,this.pageSize=e||this.pageSize,this.loading=!0,p(this.page,this.pageSize,this.searchParams).then((function(t){var e=t.data;e&&(n.table.total=null==e.total?0:e.total,n.table.data=e.rows,n.loading=!1)})).catch((function(){n.loading=!1}))},beforeUpload:function(t){var e=t.name.slice(t.name.lastIndexOf(".")+1).toLowerCase(),n=["zip","rar"];return!!n.includes(e)||(this.$message.error("只能上传zip格式的文件！"),!1)},handleImportChange:function(t){var e=this;e.spinning=!0,e.tip="正在上传文件，请稍等！","done"==t.file.status&&t.file.response.state&&("SUCCESS"==t.file.response.state?(e.spinning=!1,e.$message.success(t.file.response.data),e.update(1,10)):"FAIL"==t.file.response.state?(e.$message.error(t.file.response.msg),e.spinning=!1,e.update(1,10)):e.spinning=!1)},handleImportChange1:function(t){var e=this;"uploading"==t.file.status?(e.spinning=!0,e.progress=Math.floor(100*t.file.percent/100),e.tip="上传".concat(e.progress,"%，请稍等！")):"done"==t.file.status&&(e.progress=100,t.file.response.state&&("SUCCESS"==t.file.response.state?(e.spinning=!1,e.$message.success(t.file.response.data),e.update(1,10)):"FAIL"==t.file.response.state?(e.$message.error(t.file.response.msg),e.spinning=!1,e.update(1,10)):e.spinning=!1,e.progress=0))},deleteFile:function(t){var e=this;e.$confirm({content:"确认删除吗？",okText:"确认",cancelText:"取消",onOk:function(){var n={};n.fileName=t,Object(r["b"])("/xftp/delWorkFile",r["a"].POST,n).then((function(t){e.$message.success(t),e.update(1,10)}))},onCancel:function(){}})},downloadFile:function(t){var e="".concat(o["b"],"xftp/download?fileName=").concat(t);window.open(e,"_blank")},startTransmit:function(){var t=this;t.$confirm({content:"同步之后，在同步完成之前，无法对文件进行删除、上传、清空等操作，确认同步吗？",okText:"确认",cancelText:"取消",onOk:function(){t.transmitState=!0,t.spinning1=!0,g().then((function(e){e?(t.$message.success(e.msg),t.getGransFileXFTPState()):(t.transmitState=!1,t.spinning1=!1)})).catch((function(){t.transmitState=!1,t.spinning1=!1}))},onCancel:function(){}})},getGransFileXFTPState:function(){var t=this;t.spinning1=!0,t.refreshDsq=setInterval((function(){y().then((function(e){"SUCCESS"===e.state&&("正在同步"===e.msg?t.tip1="正在同步文件，完成".concat(e.data,"，请稍等!"):"同步完成"===e.msg&&(t.$message.success(e.msg),t.spinning1=!1,t.tip1="正在同步文件，请稍等！",t.transmitState=!1,clearInterval(t.refreshDsq),localStorage.removeItem("refreshDsq")))})).catch((function(){t.spinning1=!1,t.transmitState=!1,t.tip1="正在同步文件，请稍等！",clearInterval(t.refreshDsq),localStorage.removeItem("refreshDsq")}))}),3e3)},endTransmit:function(){this.transmitState=!1,b().then((function(t){})),this.spinning1=!1,clearInterval(this.refreshDsq),localStorage.removeItem("refreshDsq")},clearXFTPFile:function(){var t=this;t.$confirm({content:"清空后会删除所有文件，确认清空吗？",okText:"确认",cancelText:"取消",onOk:function(){t.loading=!0,h().then((function(e){e&&(t.loading=!1,t.update(1,10))})).catch((function(){t.loading=!1}))},onCancel:function(){}})}}},C=x,k=(n("561d"),n("2877")),O=Object(k["a"])(C,a,i,!1,null,"540543d2",null);e["default"]=O.exports},4166:function(t,e,n){},"561d":function(t,e,n){"use strict";n("4166")},"8c2b":function(t,e,n){"use strict";n("b381")},b381:function(t,e,n){}}]);